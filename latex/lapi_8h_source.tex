\doxysection{lapi.\+h}
\hypertarget{lapi_8h_source}{}\label{lapi_8h_source}\doxymbox{\hyperlink{lapi_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#ifndef\ lapi\_h}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#define\ lapi\_h}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}llimits.h"{}}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ "{}lstate.h"{}}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#ifndef\ api\_check}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#if\ defined(LUA\_USE\_APICHECK)}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <assert.h>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#define\ api\_check(l,e,msg)\ \ \ \ assert(e)}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#else\ \ \ }\textcolor{comment}{/*\ for\ testing\ */}\textcolor{preprocessor}{}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#define\ api\_check(l,e,msg)\ \ \ \ ((void)(l),\ lua\_assert((e)\ \&\&\ msg))}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{comment}{/*\ Increments\ 'L-\/>top.p',\ checking\ for\ stack\ overflows\ */}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#define\ api\_incr\_top(L)\ \{L-\/>top.p++;\ \(\backslash\)}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ api\_check(L,\ L-\/>top.p\ <=\ L-\/>ci-\/>top.p,\ \(\backslash\)}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}stack\ overflow"{});\}}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{comment}{/*}}
\DoxyCodeLine{00032\ \textcolor{comment}{**\ If\ a\ call\ returns\ too\ many\ multiple\ returns,\ the\ callee\ may\ not\ have}}
\DoxyCodeLine{00033\ \textcolor{comment}{**\ stack\ space\ to\ accommodate\ all\ results.\ In\ this\ case,\ this\ macro}}
\DoxyCodeLine{00034\ \textcolor{comment}{**\ increases\ its\ stack\ space\ ('L-\/>ci-\/>top.p').}}
\DoxyCodeLine{00035\ \textcolor{comment}{*/}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#define\ adjustresults(L,nres)\ \(\backslash\)}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\ \ \ \ \{\ if\ ((nres)\ <=\ LUA\_MULTRET\ \&\&\ L-\/>ci-\/>top.p\ <\ L-\/>top.p)\ \(\backslash\)}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\ \ \ \ L-\/>ci-\/>top.p\ =\ L-\/>top.p;\ \}}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{comment}{/*\ Ensure\ the\ stack\ has\ at\ least\ 'n'\ elements\ */}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#define\ api\_checknelems(L,n)\ \(\backslash\)}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\ \ \ \ \ \ \ api\_check(L,\ (n)\ <\ (L-\/>top.p\ -\/\ L-\/>ci-\/>func.p),\ \(\backslash\)}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}not\ enough\ elements\ in\ the\ stack"{})}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{comment}{/*\ Ensure\ the\ stack\ has\ at\ least\ 'n'\ elements\ to\ be\ popped.\ (Some}}
\DoxyCodeLine{00048\ \textcolor{comment}{**\ functions\ only\ update\ a\ slot\ after\ checking\ it\ for\ popping,\ but\ that}}
\DoxyCodeLine{00049\ \textcolor{comment}{**\ is\ only\ an\ optimization\ for\ a\ pop\ followed\ by\ a\ push.)}}
\DoxyCodeLine{00050\ \textcolor{comment}{*/}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#define\ hastocloseCfunc(n)\ \ ((n)\ <\ LUA\_MULTRET)}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \textcolor{comment}{/*\ Map\ [-\/1,\ inf)\ (range\ of\ 'nresults')\ into\ (-\/inf,\ -\/2]\ */}}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\#define\ codeNresults(n)\ \ \ \ \ (-\/(n)\ -\/\ 3)}}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#define\ decodeNresults(n)\ \ \ (-\/(n)\ -\/\ 3)}}
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#define\ api\_checkpop(L,n)\ \(\backslash\)}}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\ \ \ \ api\_check(L,\ (n)\ <\ L-\/>top.p\ -\/\ L-\/>ci-\/>func.p\ \&\&\ \ \(\backslash\)}}
\DoxyCodeLine{00059\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ L-\/>tbclist.p\ <\ L-\/>top.p\ -\/\ (n),\ \(\backslash\)}}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}not\ enough\ free\ elements\ in\ the\ stack"{})}}
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
