\doxysection{lgc.\+c File Reference}
\hypertarget{lgc_8c}{}\label{lgc_8c}\index{lgc.c@{lgc.c}}


Garbage Collector implementation.  


{\ttfamily \+\#include "{}lprefix.\+h"{}}\newline
{\ttfamily \+\#include $<$stdio.\+h$>$}\newline
{\ttfamily \+\#include $<$string.\+h$>$}\newline
{\ttfamily \+\#include "{}lua.\+h"{}}\newline
{\ttfamily \+\#include "{}ldebug.\+h"{}}\newline
{\ttfamily \+\#include "{}ldo.\+h"{}}\newline
{\ttfamily \+\#include "{}lfunc.\+h"{}}\newline
{\ttfamily \+\#include "{}lgc.\+h"{}}\newline
{\ttfamily \+\#include "{}lmem.\+h"{}}\newline
{\ttfamily \+\#include "{}lobject.\+h"{}}\newline
{\ttfamily \+\#include "{}lstate.\+h"{}}\newline
{\ttfamily \+\#include "{}lstring.\+h"{}}\newline
{\ttfamily \+\#include "{}ltable.\+h"{}}\newline
{\ttfamily \+\#include "{}ltm.\+h"{}}\newline
{\ttfamily \+\#include "{}lthread.\+h"{}}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{lgc_8c_a61d084c4959fdcc23103ae67105b3472}\label{lgc_8c_a61d084c4959fdcc23103ae67105b3472} 
\+\#define {\bfseries lgc\+\_\+c}
\item 
\Hypertarget{lgc_8c_abf0b3947b59218777a8e928a10be205b}\label{lgc_8c_abf0b3947b59218777a8e928a10be205b} 
\+\#define {\bfseries LUA\+\_\+\+CORE}
\item 
\Hypertarget{lgc_8c_ac31abb557425090d41f055c797049ba8}\label{lgc_8c_ac31abb557425090d41f055c797049ba8} 
\+\#define {\bfseries GCSWEEPMAX}~100
\item 
\Hypertarget{lgc_8c_ac3a3667112bce0a226dbef4640edee94}\label{lgc_8c_ac3a3667112bce0a226dbef4640edee94} 
\+\#define {\bfseries GCFINMAX}~10
\item 
\Hypertarget{lgc_8c_a84dfd5e385ed6792c171df6b6a972179}\label{lgc_8c_a84dfd5e385ed6792c171df6b6a972179} 
\+\#define {\bfseries GCFINALIZECOST}~50
\item 
\Hypertarget{lgc_8c_a2f1af1a74ed552d994ae1a8f830bd6d2}\label{lgc_8c_a2f1af1a74ed552d994ae1a8f830bd6d2} 
\+\#define {\bfseries WORK2\+MEM}~sizeof(\doxymbox{\hyperlink{struct_t_value}{TValue}})
\item 
\Hypertarget{lgc_8c_a79ef06ea1e24ee7e3d343f67e954d68c}\label{lgc_8c_a79ef06ea1e24ee7e3d343f67e954d68c} 
\+\#define {\bfseries PAUSEADJ}~100
\item 
\Hypertarget{lgc_8c_a31f875711ff997274eb999d7fe8ec639}\label{lgc_8c_a31f875711ff997274eb999d7fe8ec639} 
\+\#define {\bfseries maskcolors}~(bitmask(BLACKBIT) \texorpdfstring{$\vert$}{|} WHITEBITS)
\item 
\Hypertarget{lgc_8c_a3ea4c714396849e66d63d88a8987f149}\label{lgc_8c_a3ea4c714396849e66d63d88a8987f149} 
\+\#define {\bfseries maskgcbits}~(maskcolors \texorpdfstring{$\vert$}{|} AGEBITS)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_ada061b1d508c516b2e53f546521b3eeb}{makewhite}}(g,  x)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_ac0d91118389ea51c074e2baf41e03ccb}{set2gray}}(x)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_a1cb0182cfa6e73b1665658a79c297d46}{set2black}}(x)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_a84251731518ce7f66d49363eb9f0f594}{valiswhite}}(x)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_a4e2cb724f6d35593354bd90084b87d49}{keyiswhite}}(n)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_a7c7f051ea3f0945577e90c480ebeee88}{gcvalueN}}(o)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_a2dd4136ac29665568973c074bc450849}{markvalue}}(g,  o)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_a177a5a645b1409b4f1c20e3c84018d40}{markkey}}(g,  n)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_a6ae72c43e48b29944e55933df7f15482}{markobject}}(g,  t)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_af9d4ee7e422989e2c45413745252211b}{markobjectN}}(g,  t)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_a43ef7b8388b613e737dd3ec7eb493f47}{gnodelast}}(h)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_ad63f9d59a67a756d3c3540d9795cdcbe}{linkgclist}}(o,  p)
\item 
\+\#define \doxymbox{\hyperlink{lgc_8c_a69a219e9e1a524d24173ef477419f87c}{linkobjgclist}}(o,  p)
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \doxymbox{\hyperlink{lgc_8c_a72c69b5d5554e0ea4b65e894f2a50793}{lua\+C\+\_\+barrier\+\_\+}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, \doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*}o, \doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*}v)
\begin{DoxyCompactList}\small\item\em Barrier that moves collector forward. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{lgc_8c_a61ad59cdf3484ff64c0c3cb7a48388ad}{lua\+C\+\_\+barrierback\+\_\+}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, \doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*}o)
\begin{DoxyCompactList}\small\item\em Barrier that moves collector backward. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{lgc_8c_a77a9b70a49730bb007a8a9492687d0eb}{lua\+C\+\_\+fix}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, \doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*}o)
\begin{DoxyCompactList}\small\item\em Moves an object to the fixed list, so it will never be collected. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{lgc_8c_a2d118d8d8d0ffbab87d70d2b05c41fec}{lua\+C\+\_\+newobjdt}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, int tt, size\+\_\+t sz, size\+\_\+t offset)
\begin{DoxyCompactList}\small\item\em Creates a new collectable object and links it to the \textquotesingle{}allgc\textquotesingle{} list. \end{DoxyCompactList}\item 
\doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*} \doxymbox{\hyperlink{lgc_8c_add162bc704b7ea7de8f51eb99fd531aa}{lua\+C\+\_\+newobj}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, int tt, size\+\_\+t sz)
\begin{DoxyCompactList}\small\item\em Creates a new collectable object. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{lgc_8c_a0d4f5fb6a8831817e117cfff473aeb0e}{lua\+C\+\_\+checkfinalizer}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, \doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*}o, \doxymbox{\hyperlink{struct_table}{Table}} \texorpdfstring{$\ast$}{*}mt)
\begin{DoxyCompactList}\small\item\em Checks if an object needs to be moved to the finalization list. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{lgc_8c_ac88d5c236307393937e02bc82c10f970}{lua\+C\+\_\+changemode}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, int newmode)
\begin{DoxyCompactList}\small\item\em Changes the collector mode. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{lgc_8c_abad938b33f011ec1088d1a79508c6ac9}{lua\+C\+\_\+freeallobjects}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L)
\begin{DoxyCompactList}\small\item\em Calls all finalizers of the objects in the given Lua state, and then frees all objects, except for the main thread. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{lgc_8c_a97086b84273579d4c9b42a782f30410d}{lua\+C\+\_\+runtilstate}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, int statesmask)
\begin{DoxyCompactList}\small\item\em Advances the garbage collector until it reaches a state allowed by \textquotesingle{}statemask\textquotesingle{}. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{lgc_8c_ab0133eb7bb37a0a690e0ef71fbc13414}{lua\+C\+\_\+step}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L)
\begin{DoxyCompactList}\small\item\em Performs a basic GC step if collector is running. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{lgc_8c_ac48130e5263ad8be09a9c51dae6125b9}{lua\+C\+\_\+fullgc}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, int isemergency)
\begin{DoxyCompactList}\small\item\em Performs a full GC cycle. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Garbage Collector implementation. 

This file contains the implementation of the Lua garbage collector (GC), supporting both incremental and generational modes. 

\label{doc-define-members}
\Hypertarget{lgc_8c_doc-define-members}
\doxysubsection{Macro Definition Documentation}
\Hypertarget{lgc_8c_a7c7f051ea3f0945577e90c480ebeee88}\index{lgc.c@{lgc.c}!gcvalueN@{gcvalueN}}
\index{gcvalueN@{gcvalueN}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{gcvalueN}{gcvalueN}}
{\footnotesize\ttfamily \label{lgc_8c_a7c7f051ea3f0945577e90c480ebeee88} 
\+\#define gcvalueN(\begin{DoxyParamCaption}\item[{}]{o}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{(iscollectable(o)\ ?\ gcvalue(o)\ :\ NULL)}

\end{DoxyCode}
\Hypertarget{lgc_8c_a43ef7b8388b613e737dd3ec7eb493f47}\index{lgc.c@{lgc.c}!gnodelast@{gnodelast}}
\index{gnodelast@{gnodelast}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{gnodelast}{gnodelast}}
{\footnotesize\ttfamily \label{lgc_8c_a43ef7b8388b613e737dd3ec7eb493f47} 
\+\#define gnodelast(\begin{DoxyParamCaption}\item[{}]{h}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{gnode(h,\ cast\_sizet(sizenode(h)))}

\end{DoxyCode}
\Hypertarget{lgc_8c_a4e2cb724f6d35593354bd90084b87d49}\index{lgc.c@{lgc.c}!keyiswhite@{keyiswhite}}
\index{keyiswhite@{keyiswhite}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{keyiswhite}{keyiswhite}}
{\footnotesize\ttfamily \label{lgc_8c_a4e2cb724f6d35593354bd90084b87d49} 
\+\#define keyiswhite(\begin{DoxyParamCaption}\item[{}]{n}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{(keyiscollectable(n)\ \&\&\ iswhite(gckey(n)))}

\end{DoxyCode}
\Hypertarget{lgc_8c_ad63f9d59a67a756d3c3540d9795cdcbe}\index{lgc.c@{lgc.c}!linkgclist@{linkgclist}}
\index{linkgclist@{linkgclist}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{linkgclist}{linkgclist}}
{\footnotesize\ttfamily \label{lgc_8c_ad63f9d59a67a756d3c3540d9795cdcbe} 
\+\#define linkgclist(\begin{DoxyParamCaption}\item[{}]{o}{, }\item[{}]{p}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{linkgclist\_(obj2gco(o),\ \&(o)-\/>gclist,\ \&(p))}

\end{DoxyCode}
\Hypertarget{lgc_8c_a69a219e9e1a524d24173ef477419f87c}\index{lgc.c@{lgc.c}!linkobjgclist@{linkobjgclist}}
\index{linkobjgclist@{linkobjgclist}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{linkobjgclist}{linkobjgclist}}
{\footnotesize\ttfamily \label{lgc_8c_a69a219e9e1a524d24173ef477419f87c} 
\+\#define linkobjgclist(\begin{DoxyParamCaption}\item[{}]{o}{, }\item[{}]{p}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{linkgclist\_(obj2gco(o),\ getgclist(o),\ \&(p))}

\end{DoxyCode}
\Hypertarget{lgc_8c_ada061b1d508c516b2e53f546521b3eeb}\index{lgc.c@{lgc.c}!makewhite@{makewhite}}
\index{makewhite@{makewhite}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{makewhite}{makewhite}}
{\footnotesize\ttfamily \label{lgc_8c_ada061b1d508c516b2e53f546521b3eeb} 
\+\#define makewhite(\begin{DoxyParamCaption}\item[{}]{g}{, }\item[{}]{x}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{(x-\/>marked\ =\ cast\_byte((x-\/>marked\ \&\ \string~maskcolors)\ |\ luaC\_white(g)))}

\end{DoxyCode}
\Hypertarget{lgc_8c_a177a5a645b1409b4f1c20e3c84018d40}\index{lgc.c@{lgc.c}!markkey@{markkey}}
\index{markkey@{markkey}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{markkey}{markkey}}
{\footnotesize\ttfamily \label{lgc_8c_a177a5a645b1409b4f1c20e3c84018d40} 
\+\#define markkey(\begin{DoxyParamCaption}\item[{}]{g}{, }\item[{}]{n}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{\ \textcolor{keywordflow}{if}\ keyiswhite(n)\ reallymarkobject(g,gckey(n));\ \}}

\end{DoxyCode}
\Hypertarget{lgc_8c_a6ae72c43e48b29944e55933df7f15482}\index{lgc.c@{lgc.c}!markobject@{markobject}}
\index{markobject@{markobject}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{markobject}{markobject}}
{\footnotesize\ttfamily \label{lgc_8c_a6ae72c43e48b29944e55933df7f15482} 
\+\#define markobject(\begin{DoxyParamCaption}\item[{}]{g}{, }\item[{}]{t}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{\ \textcolor{keywordflow}{if}\ (iswhite(t))\ reallymarkobject(g,\ obj2gco(t));\ \}}

\end{DoxyCode}
\Hypertarget{lgc_8c_af9d4ee7e422989e2c45413745252211b}\index{lgc.c@{lgc.c}!markobjectN@{markobjectN}}
\index{markobjectN@{markobjectN}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{markobjectN}{markobjectN}}
{\footnotesize\ttfamily \label{lgc_8c_af9d4ee7e422989e2c45413745252211b} 
\+\#define markobjectN(\begin{DoxyParamCaption}\item[{}]{g}{, }\item[{}]{t}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{\ \textcolor{keywordflow}{if}\ (t)\ markobject(g,t);\ \}}

\end{DoxyCode}
\Hypertarget{lgc_8c_a2dd4136ac29665568973c074bc450849}\index{lgc.c@{lgc.c}!markvalue@{markvalue}}
\index{markvalue@{markvalue}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{markvalue}{markvalue}}
{\footnotesize\ttfamily \label{lgc_8c_a2dd4136ac29665568973c074bc450849} 
\+\#define markvalue(\begin{DoxyParamCaption}\item[{}]{g}{, }\item[{}]{o}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{\{\ checkliveness(g-\/>mainthread,o);\ \(\backslash\)}
\DoxyCodeLine{if\ (valiswhite(o))\ reallymarkobject(g,gcvalue(o));\ \}}

\end{DoxyCode}
\Hypertarget{lgc_8c_a1cb0182cfa6e73b1665658a79c297d46}\index{lgc.c@{lgc.c}!set2black@{set2black}}
\index{set2black@{set2black}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{set2black}{set2black}}
{\footnotesize\ttfamily \label{lgc_8c_a1cb0182cfa6e73b1665658a79c297d46} 
\+\#define set2black(\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{(x-\/>marked\ =\ cast\_byte((x-\/>marked\ \&\ \string~WHITEBITS)\ |\ bitmask(BLACKBIT)))}

\end{DoxyCode}
\Hypertarget{lgc_8c_ac0d91118389ea51c074e2baf41e03ccb}\index{lgc.c@{lgc.c}!set2gray@{set2gray}}
\index{set2gray@{set2gray}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{set2gray}{set2gray}}
{\footnotesize\ttfamily \label{lgc_8c_ac0d91118389ea51c074e2baf41e03ccb} 
\+\#define set2gray(\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{resetbits(x-\/>marked,\ maskcolors)}

\end{DoxyCode}
\Hypertarget{lgc_8c_a84251731518ce7f66d49363eb9f0f594}\index{lgc.c@{lgc.c}!valiswhite@{valiswhite}}
\index{valiswhite@{valiswhite}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{valiswhite}{valiswhite}}
{\footnotesize\ttfamily \label{lgc_8c_a84251731518ce7f66d49363eb9f0f594} 
\+\#define valiswhite(\begin{DoxyParamCaption}\item[{}]{x}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{(iscollectable(x)\ \&\&\ iswhite(gcvalue(x)))}

\end{DoxyCode}


\label{doc-func-members}
\Hypertarget{lgc_8c_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{lgc_8c_a72c69b5d5554e0ea4b65e894f2a50793}\index{lgc.c@{lgc.c}!luaC\_barrier\_@{luaC\_barrier\_}}
\index{luaC\_barrier\_@{luaC\_barrier\_}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{luaC\_barrier\_()}{luaC\_barrier\_()}}
{\footnotesize\ttfamily \label{lgc_8c_a72c69b5d5554e0ea4b65e894f2a50793} 
void lua\+C\+\_\+barrier\+\_\+ (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{\doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*}}]{o}{, }\item[{\doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*}}]{v}{}\end{DoxyParamCaption})}



Barrier that moves collector forward. 

Marks the white object \textquotesingle{}v\textquotesingle{} being pointed by the black object \textquotesingle{}o\textquotesingle{}. In the generational mode, \textquotesingle{}v\textquotesingle{} must also become old, if \textquotesingle{}o\textquotesingle{} is old; however, it cannot be changed directly to OLD, because it may still point to non-\/old objects. So, it is marked as OLD0. In the next cycle it will become OLD1, and in the next it will finally become OLD (regular old). By then, any object it points to will also be old. If called in the incremental sweep phase, it clears the black object to white (sweep it) to avoid other barrier calls for this same object.


\begin{DoxyParams}{Parameters}
{\em L} & The Lua state. \\
\hline
{\em o} & The parent object (black). \\
\hline
{\em v} & The child object (white). \\
\hline
\end{DoxyParams}
\Hypertarget{lgc_8c_a61ad59cdf3484ff64c0c3cb7a48388ad}\index{lgc.c@{lgc.c}!luaC\_barrierback\_@{luaC\_barrierback\_}}
\index{luaC\_barrierback\_@{luaC\_barrierback\_}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{luaC\_barrierback\_()}{luaC\_barrierback\_()}}
{\footnotesize\ttfamily \label{lgc_8c_a61ad59cdf3484ff64c0c3cb7a48388ad} 
void lua\+C\+\_\+barrierback\+\_\+ (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{\doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*}}]{o}{}\end{DoxyParamCaption})}



Barrier that moves collector backward. 

Marks the black object pointing to a white object as gray again.


\begin{DoxyParams}{Parameters}
{\em L} & The Lua state. \\
\hline
{\em o} & The parent object (black). \\
\hline
\end{DoxyParams}
\Hypertarget{lgc_8c_ac88d5c236307393937e02bc82c10f970}\index{lgc.c@{lgc.c}!luaC\_changemode@{luaC\_changemode}}
\index{luaC\_changemode@{luaC\_changemode}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{luaC\_changemode()}{luaC\_changemode()}}
{\footnotesize\ttfamily \label{lgc_8c_ac88d5c236307393937e02bc82c10f970} 
void lua\+C\+\_\+changemode (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{int}]{newmode}{}\end{DoxyParamCaption})}



Changes the collector mode. 


\begin{DoxyParams}{Parameters}
{\em L} & The Lua state. \\
\hline
{\em newmode} & The new mode (KGC\+\_\+\+GENH or KGC\+\_\+\+INC). \\
\hline
\end{DoxyParams}
\Hypertarget{lgc_8c_a0d4f5fb6a8831817e117cfff473aeb0e}\index{lgc.c@{lgc.c}!luaC\_checkfinalizer@{luaC\_checkfinalizer}}
\index{luaC\_checkfinalizer@{luaC\_checkfinalizer}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{luaC\_checkfinalizer()}{luaC\_checkfinalizer()}}
{\footnotesize\ttfamily \label{lgc_8c_a0d4f5fb6a8831817e117cfff473aeb0e} 
void lua\+C\+\_\+checkfinalizer (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{\doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*}}]{o}{, }\item[{\doxymbox{\hyperlink{struct_table}{Table}} \texorpdfstring{$\ast$}{*}}]{mt}{}\end{DoxyParamCaption})}



Checks if an object needs to be moved to the finalization list. 

If object \textquotesingle{}o\textquotesingle{} has a finalizer and hasn\textquotesingle{}t been finalized yet, remove it from the \textquotesingle{}allgc\textquotesingle{} list and link it in the \textquotesingle{}finobj\textquotesingle{} list.


\begin{DoxyParams}{Parameters}
{\em L} & The Lua state. \\
\hline
{\em o} & The object to check. \\
\hline
{\em mt} & The metatable of the object. \\
\hline
\end{DoxyParams}
\Hypertarget{lgc_8c_a77a9b70a49730bb007a8a9492687d0eb}\index{lgc.c@{lgc.c}!luaC\_fix@{luaC\_fix}}
\index{luaC\_fix@{luaC\_fix}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{luaC\_fix()}{luaC\_fix()}}
{\footnotesize\ttfamily \label{lgc_8c_a77a9b70a49730bb007a8a9492687d0eb} 
void lua\+C\+\_\+fix (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{\doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*}}]{o}{}\end{DoxyParamCaption})}



Moves an object to the fixed list, so it will never be collected. 


\begin{DoxyParams}{Parameters}
{\em L} & The Lua state. \\
\hline
{\em o} & The object to fix. \\
\hline
\end{DoxyParams}
\Hypertarget{lgc_8c_abad938b33f011ec1088d1a79508c6ac9}\index{lgc.c@{lgc.c}!luaC\_freeallobjects@{luaC\_freeallobjects}}
\index{luaC\_freeallobjects@{luaC\_freeallobjects}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{luaC\_freeallobjects()}{luaC\_freeallobjects()}}
{\footnotesize\ttfamily \label{lgc_8c_abad938b33f011ec1088d1a79508c6ac9} 
void lua\+C\+\_\+freeallobjects (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{}\end{DoxyParamCaption})}



Calls all finalizers of the objects in the given Lua state, and then frees all objects, except for the main thread. 


\begin{DoxyParams}{Parameters}
{\em L} & The Lua state. \\
\hline
\end{DoxyParams}
\Hypertarget{lgc_8c_ac48130e5263ad8be09a9c51dae6125b9}\index{lgc.c@{lgc.c}!luaC\_fullgc@{luaC\_fullgc}}
\index{luaC\_fullgc@{luaC\_fullgc}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{luaC\_fullgc()}{luaC\_fullgc()}}
{\footnotesize\ttfamily \label{lgc_8c_ac48130e5263ad8be09a9c51dae6125b9} 
void lua\+C\+\_\+fullgc (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{int}]{isemergency}{}\end{DoxyParamCaption})}



Performs a full GC cycle. 


\begin{DoxyParams}{Parameters}
{\em L} & The Lua state. \\
\hline
{\em isemergency} & If true, sets a flag to avoid some operations which could change the interpreter state in some unexpected ways. \\
\hline
\end{DoxyParams}
\Hypertarget{lgc_8c_add162bc704b7ea7de8f51eb99fd531aa}\index{lgc.c@{lgc.c}!luaC\_newobj@{luaC\_newobj}}
\index{luaC\_newobj@{luaC\_newobj}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{luaC\_newobj()}{luaC\_newobj()}}
{\footnotesize\ttfamily \label{lgc_8c_add162bc704b7ea7de8f51eb99fd531aa} 
\doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*} lua\+C\+\_\+newobj (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{int}]{tt}{, }\item[{size\+\_\+t}]{sz}{}\end{DoxyParamCaption})}



Creates a new collectable object. 


\begin{DoxyParams}{Parameters}
{\em L} & The Lua state. \\
\hline
{\em tt} & Object type tag. \\
\hline
{\em sz} & Size of the object. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The new \doxylink{struct_g_c_object}{GCObject}. 
\end{DoxyReturn}
\Hypertarget{lgc_8c_a2d118d8d8d0ffbab87d70d2b05c41fec}\index{lgc.c@{lgc.c}!luaC\_newobjdt@{luaC\_newobjdt}}
\index{luaC\_newobjdt@{luaC\_newobjdt}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{luaC\_newobjdt()}{luaC\_newobjdt()}}
{\footnotesize\ttfamily \label{lgc_8c_a2d118d8d8d0ffbab87d70d2b05c41fec} 
\doxymbox{\hyperlink{struct_g_c_object}{GCObject}} \texorpdfstring{$\ast$}{*} lua\+C\+\_\+newobjdt (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{int}]{tt}{, }\item[{size\+\_\+t}]{sz}{, }\item[{size\+\_\+t}]{offset}{}\end{DoxyParamCaption})}



Creates a new collectable object and links it to the \textquotesingle{}allgc\textquotesingle{} list. 


\begin{DoxyParams}{Parameters}
{\em L} & The Lua state. \\
\hline
{\em tt} & Object type tag. \\
\hline
{\em sz} & Size of the object. \\
\hline
{\em offset} & Offset to the \doxylink{struct_g_c_object}{GCObject} header. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The new \doxylink{struct_g_c_object}{GCObject}. 
\end{DoxyReturn}
\Hypertarget{lgc_8c_a97086b84273579d4c9b42a782f30410d}\index{lgc.c@{lgc.c}!luaC\_runtilstate@{luaC\_runtilstate}}
\index{luaC\_runtilstate@{luaC\_runtilstate}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{luaC\_runtilstate()}{luaC\_runtilstate()}}
{\footnotesize\ttfamily \label{lgc_8c_a97086b84273579d4c9b42a782f30410d} 
void lua\+C\+\_\+runtilstate (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{int}]{statesmask}{}\end{DoxyParamCaption})}



Advances the garbage collector until it reaches a state allowed by \textquotesingle{}statemask\textquotesingle{}. 


\begin{DoxyParams}{Parameters}
{\em L} & The Lua state. \\
\hline
{\em statesmask} & Bitmask of allowed states. \\
\hline
\end{DoxyParams}
\Hypertarget{lgc_8c_ab0133eb7bb37a0a690e0ef71fbc13414}\index{lgc.c@{lgc.c}!luaC\_step@{luaC\_step}}
\index{luaC\_step@{luaC\_step}!lgc.c@{lgc.c}}
\doxysubsubsection{\texorpdfstring{luaC\_step()}{luaC\_step()}}
{\footnotesize\ttfamily \label{lgc_8c_ab0133eb7bb37a0a690e0ef71fbc13414} 
void lua\+C\+\_\+step (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{}\end{DoxyParamCaption})}



Performs a basic GC step if collector is running. 

If collector is not running, set a reasonable debt to avoid it being called at every single check.


\begin{DoxyParams}{Parameters}
{\em L} & The Lua state. \\
\hline
\end{DoxyParams}
