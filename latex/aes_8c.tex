\doxysection{aes.\+c File Reference}
\hypertarget{aes_8c}{}\label{aes_8c}\index{aes.c@{aes.c}}


AES algorithm implementation.  


{\ttfamily \+\#include $<$stdint.\+h$>$}\newline
{\ttfamily \+\#include $<$string.\+h$>$}\newline
{\ttfamily \+\#include "{}aes.\+h"{}}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{aes_8c_a1ae104196f1fc7af4751c5b9e07b1610}\label{aes_8c_a1ae104196f1fc7af4751c5b9e07b1610} 
\+\#define {\bfseries Nb}~4
\item 
\Hypertarget{aes_8c_a7b1938df390b1afe917e8baa663c22af}\label{aes_8c_a7b1938df390b1afe917e8baa663c22af} 
\+\#define {\bfseries Nk}~4
\item 
\Hypertarget{aes_8c_a9d210afc812225ee0a0bcd51bb984246}\label{aes_8c_a9d210afc812225ee0a0bcd51bb984246} 
\+\#define {\bfseries Nr}~10
\item 
\Hypertarget{aes_8c_a1dd86ce8e7ff32d6456f34c281c7e2a9}\label{aes_8c_a1dd86ce8e7ff32d6456f34c281c7e2a9} 
\+\#define {\bfseries MULTIPLY\+\_\+\+AS\+\_\+\+A\+\_\+\+FUNCTION}~0
\item 
\+\#define \doxymbox{\hyperlink{aes_8c_a5e1678341a98f95d48365ed9ccaa3586}{get\+SBox\+Value}}(num)
\item 
\+\#define \doxymbox{\hyperlink{aes_8c_a4223d41bc5587f9c0b6e499004403967}{get\+SBox\+Invert}}(num)
\item 
\+\#define \doxymbox{\hyperlink{aes_8c_aca7cce176b8cdd27f61d3dcf5910b6bd}{Multiply}}(x,  y)
\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{aes_8c_a35dbb26673d196810a7f6eac0ac632ec}\label{aes_8c_a35dbb26673d196810a7f6eac0ac632ec} 
typedef uint8\+\_\+t {\bfseries state\+\_\+t}\+[4]\+\+[4]\+
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \doxymbox{\hyperlink{aes_8c_af6103754d8f46cb642b0041973e4102e}{AES\+\_\+init\+\_\+ctx}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}key)
\begin{DoxyCompactList}\small\item\em Initializes an AES context with a given key. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8c_a99d17d22ed909bd155007cdece29263a}{AES\+\_\+init\+\_\+ctx\+\_\+iv}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}key, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}iv)
\begin{DoxyCompactList}\small\item\em Initializes an AES context with a given key and IV. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8c_afbdec54757622549b63838ea2fbc3cf6}{AES\+\_\+ctx\+\_\+set\+\_\+iv}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}iv)
\begin{DoxyCompactList}\small\item\em Sets the IV in an existing AES context. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8c_abbe38e5c8a65203e1c81751e86f7b691}{AES\+\_\+\+ECB\+\_\+encrypt}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}buf)
\begin{DoxyCompactList}\small\item\em Encrypts a single block using ECB mode. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8c_afe44b8e0e4e6809d69ebdb5d24811728}{AES\+\_\+\+ECB\+\_\+decrypt}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}buf)
\begin{DoxyCompactList}\small\item\em Decrypts a single block using ECB mode. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8c_aeccef1909c8c9668e09db27d9d0e439f}{AES\+\_\+\+CBC\+\_\+encrypt\+\_\+buffer}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}buf, uint32\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Encrypts a buffer using CBC mode. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8c_a075ca81a07881b319c814bedb8b58f51}{AES\+\_\+\+CBC\+\_\+decrypt\+\_\+buffer}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}buf, uint32\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Decrypts a buffer using CBC mode. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8c_a4c7968d6e1646ac3bbc0b10ad9c72b7d}{AES\+\_\+\+CTR\+\_\+xcrypt\+\_\+buffer}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}buf, uint32\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Encrypts/\+decrypts a buffer using CTR mode. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
AES algorithm implementation. 



\label{doc-define-members}
\Hypertarget{aes_8c_doc-define-members}
\doxysubsection{Macro Definition Documentation}
\Hypertarget{aes_8c_a4223d41bc5587f9c0b6e499004403967}\index{aes.c@{aes.c}!getSBoxInvert@{getSBoxInvert}}
\index{getSBoxInvert@{getSBoxInvert}!aes.c@{aes.c}}
\doxysubsubsection{\texorpdfstring{getSBoxInvert}{getSBoxInvert}}
{\footnotesize\ttfamily \label{aes_8c_a4223d41bc5587f9c0b6e499004403967} 
\+\#define get\+SBox\+Invert(\begin{DoxyParamCaption}\item[{}]{num}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{(rsbox[(num)])}

\end{DoxyCode}
\Hypertarget{aes_8c_a5e1678341a98f95d48365ed9ccaa3586}\index{aes.c@{aes.c}!getSBoxValue@{getSBoxValue}}
\index{getSBoxValue@{getSBoxValue}!aes.c@{aes.c}}
\doxysubsubsection{\texorpdfstring{getSBoxValue}{getSBoxValue}}
{\footnotesize\ttfamily \label{aes_8c_a5e1678341a98f95d48365ed9ccaa3586} 
\+\#define get\+SBox\+Value(\begin{DoxyParamCaption}\item[{}]{num}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{(sbox[(num)])}

\end{DoxyCode}
\Hypertarget{aes_8c_aca7cce176b8cdd27f61d3dcf5910b6bd}\index{aes.c@{aes.c}!Multiply@{Multiply}}
\index{Multiply@{Multiply}!aes.c@{aes.c}}
\doxysubsubsection{\texorpdfstring{Multiply}{Multiply}}
{\footnotesize\ttfamily \label{aes_8c_aca7cce176b8cdd27f61d3dcf5910b6bd} 
\+\#define Multiply(\begin{DoxyParamCaption}\item[{}]{x}{, }\item[{}]{y}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{(\ \ ((y\ \&\ 1)\ *\ x)\ \string^\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{((y>>1\ \&\ 1)\ *\ xtime(x))\ \string^\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{((y>>2\ \&\ 1)\ *\ xtime(xtime(x)))\ \string^\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{((y>>3\ \&\ 1)\ *\ xtime(xtime(xtime(x))))\ \string^\ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{((y>>4\ \&\ 1)\ *\ xtime(xtime(xtime(xtime(x))))))\ \ \ \(\backslash\)}

\end{DoxyCode}


\label{doc-func-members}
\Hypertarget{aes_8c_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{aes_8c_a075ca81a07881b319c814bedb8b58f51}\index{aes.c@{aes.c}!AES\_CBC\_decrypt\_buffer@{AES\_CBC\_decrypt\_buffer}}
\index{AES\_CBC\_decrypt\_buffer@{AES\_CBC\_decrypt\_buffer}!aes.c@{aes.c}}
\doxysubsubsection{\texorpdfstring{AES\_CBC\_decrypt\_buffer()}{AES\_CBC\_decrypt\_buffer()}}
{\footnotesize\ttfamily \label{aes_8c_a075ca81a07881b319c814bedb8b58f51} 
void AES\+\_\+\+CBC\+\_\+decrypt\+\_\+buffer (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{, }\item[{uint32\+\_\+t}]{length}{}\end{DoxyParamCaption})}



Decrypts a buffer using CBC mode. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em buf} & Pointer to the data buffer. \\
\hline
{\em length} & Length of the buffer in bytes (must be a multiple of AES\+\_\+\+BLOCKLEN). \\
\hline
\end{DoxyParams}
\Hypertarget{aes_8c_aeccef1909c8c9668e09db27d9d0e439f}\index{aes.c@{aes.c}!AES\_CBC\_encrypt\_buffer@{AES\_CBC\_encrypt\_buffer}}
\index{AES\_CBC\_encrypt\_buffer@{AES\_CBC\_encrypt\_buffer}!aes.c@{aes.c}}
\doxysubsubsection{\texorpdfstring{AES\_CBC\_encrypt\_buffer()}{AES\_CBC\_encrypt\_buffer()}}
{\footnotesize\ttfamily \label{aes_8c_aeccef1909c8c9668e09db27d9d0e439f} 
void AES\+\_\+\+CBC\+\_\+encrypt\+\_\+buffer (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{, }\item[{uint32\+\_\+t}]{length}{}\end{DoxyParamCaption})}



Encrypts a buffer using CBC mode. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em buf} & Pointer to the data buffer. \\
\hline
{\em length} & Length of the buffer in bytes (must be a multiple of AES\+\_\+\+BLOCKLEN). \\
\hline
\end{DoxyParams}
\Hypertarget{aes_8c_a4c7968d6e1646ac3bbc0b10ad9c72b7d}\index{aes.c@{aes.c}!AES\_CTR\_xcrypt\_buffer@{AES\_CTR\_xcrypt\_buffer}}
\index{AES\_CTR\_xcrypt\_buffer@{AES\_CTR\_xcrypt\_buffer}!aes.c@{aes.c}}
\doxysubsubsection{\texorpdfstring{AES\_CTR\_xcrypt\_buffer()}{AES\_CTR\_xcrypt\_buffer()}}
{\footnotesize\ttfamily \label{aes_8c_a4c7968d6e1646ac3bbc0b10ad9c72b7d} 
void AES\+\_\+\+CTR\+\_\+xcrypt\+\_\+buffer (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{, }\item[{uint32\+\_\+t}]{length}{}\end{DoxyParamCaption})}



Encrypts/\+decrypts a buffer using CTR mode. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em buf} & Pointer to the data buffer. \\
\hline
{\em length} & Length of the buffer in bytes. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
CTR mode is symmetrical; the same function is used for encryption and decryption. 
\end{DoxyNote}
\Hypertarget{aes_8c_afbdec54757622549b63838ea2fbc3cf6}\index{aes.c@{aes.c}!AES\_ctx\_set\_iv@{AES\_ctx\_set\_iv}}
\index{AES\_ctx\_set\_iv@{AES\_ctx\_set\_iv}!aes.c@{aes.c}}
\doxysubsubsection{\texorpdfstring{AES\_ctx\_set\_iv()}{AES\_ctx\_set\_iv()}}
{\footnotesize\ttfamily \label{aes_8c_afbdec54757622549b63838ea2fbc3cf6} 
void AES\+\_\+ctx\+\_\+set\+\_\+iv (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{iv}{}\end{DoxyParamCaption})}



Sets the IV in an existing AES context. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em iv} & Pointer to the new Initialization Vector. \\
\hline
\end{DoxyParams}
\Hypertarget{aes_8c_afe44b8e0e4e6809d69ebdb5d24811728}\index{aes.c@{aes.c}!AES\_ECB\_decrypt@{AES\_ECB\_decrypt}}
\index{AES\_ECB\_decrypt@{AES\_ECB\_decrypt}!aes.c@{aes.c}}
\doxysubsubsection{\texorpdfstring{AES\_ECB\_decrypt()}{AES\_ECB\_decrypt()}}
{\footnotesize\ttfamily \label{aes_8c_afe44b8e0e4e6809d69ebdb5d24811728} 
void AES\+\_\+\+ECB\+\_\+decrypt (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{}\end{DoxyParamCaption})}



Decrypts a single block using ECB mode. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em buf} & Pointer to the data block (AES\+\_\+\+BLOCKLEN bytes). \\
\hline
\end{DoxyParams}
\Hypertarget{aes_8c_abbe38e5c8a65203e1c81751e86f7b691}\index{aes.c@{aes.c}!AES\_ECB\_encrypt@{AES\_ECB\_encrypt}}
\index{AES\_ECB\_encrypt@{AES\_ECB\_encrypt}!aes.c@{aes.c}}
\doxysubsubsection{\texorpdfstring{AES\_ECB\_encrypt()}{AES\_ECB\_encrypt()}}
{\footnotesize\ttfamily \label{aes_8c_abbe38e5c8a65203e1c81751e86f7b691} 
void AES\+\_\+\+ECB\+\_\+encrypt (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{}\end{DoxyParamCaption})}



Encrypts a single block using ECB mode. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em buf} & Pointer to the data block (AES\+\_\+\+BLOCKLEN bytes). \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
ECB is considered insecure for most uses. 
\end{DoxyNote}
\Hypertarget{aes_8c_af6103754d8f46cb642b0041973e4102e}\index{aes.c@{aes.c}!AES\_init\_ctx@{AES\_init\_ctx}}
\index{AES\_init\_ctx@{AES\_init\_ctx}!aes.c@{aes.c}}
\doxysubsubsection{\texorpdfstring{AES\_init\_ctx()}{AES\_init\_ctx()}}
{\footnotesize\ttfamily \label{aes_8c_af6103754d8f46cb642b0041973e4102e} 
void AES\+\_\+init\+\_\+ctx (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{key}{}\end{DoxyParamCaption})}



Initializes an AES context with a given key. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em key} & Pointer to the key. \\
\hline
\end{DoxyParams}
\Hypertarget{aes_8c_a99d17d22ed909bd155007cdece29263a}\index{aes.c@{aes.c}!AES\_init\_ctx\_iv@{AES\_init\_ctx\_iv}}
\index{AES\_init\_ctx\_iv@{AES\_init\_ctx\_iv}!aes.c@{aes.c}}
\doxysubsubsection{\texorpdfstring{AES\_init\_ctx\_iv()}{AES\_init\_ctx\_iv()}}
{\footnotesize\ttfamily \label{aes_8c_a99d17d22ed909bd155007cdece29263a} 
void AES\+\_\+init\+\_\+ctx\+\_\+iv (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{key}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{iv}{}\end{DoxyParamCaption})}



Initializes an AES context with a given key and IV. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em key} & Pointer to the key. \\
\hline
{\em iv} & Pointer to the Initialization Vector. \\
\hline
\end{DoxyParams}
