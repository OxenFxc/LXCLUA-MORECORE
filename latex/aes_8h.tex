\doxysection{aes.\+h File Reference}
\hypertarget{aes_8h}{}\label{aes_8h}\index{aes.h@{aes.h}}


AES algorithm implementation (ECB, CTR, CBC modes).  


{\ttfamily \+\#include $<$stdint.\+h$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}}
\begin{DoxyCompactList}\small\item\em AES context structure. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{aes_8h_a08835843c9d6a68371f350c015a83fd7}\label{aes_8h_a08835843c9d6a68371f350c015a83fd7} 
\+\#define {\bfseries CBC}~1
\item 
\Hypertarget{aes_8h_ab80203aded373ef3e2695b0903b53471}\label{aes_8h_ab80203aded373ef3e2695b0903b53471} 
\+\#define {\bfseries ECB}~1
\item 
\Hypertarget{aes_8h_aa445a79fc0f7373036c72d198e51f19a}\label{aes_8h_aa445a79fc0f7373036c72d198e51f19a} 
\+\#define {\bfseries CTR}~1
\item 
\Hypertarget{aes_8h_a3995323194aac36a671efefa1fbf9cc1}\label{aes_8h_a3995323194aac36a671efefa1fbf9cc1} 
\+\#define {\bfseries AES128}~1
\item 
\Hypertarget{aes_8h_ada62b7b09dab0d7ef92c04364b16b5b5}\label{aes_8h_ada62b7b09dab0d7ef92c04364b16b5b5} 
\+\#define {\bfseries AES\+\_\+\+BLOCKLEN}~16
\begin{DoxyCompactList}\small\item\em Block length in bytes. AES is 128-\/bit block only. \end{DoxyCompactList}\item 
\Hypertarget{aes_8h_af37c01fbc1515e7a416c14025c8bf843}\label{aes_8h_af37c01fbc1515e7a416c14025c8bf843} 
\+\#define {\bfseries AES\+\_\+\+KEYLEN}~16   /\+\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*} @brief Key length in bytes. \texorpdfstring{$\ast$}{*}/\+
\item 
\Hypertarget{aes_8h_a9aaae67ad3ff3be7071bb6938c76fc1b}\label{aes_8h_a9aaae67ad3ff3be7071bb6938c76fc1b} 
\+\#define {\bfseries AES\+\_\+key\+Exp\+Size}~176
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \doxymbox{\hyperlink{aes_8h_af6103754d8f46cb642b0041973e4102e}{AES\+\_\+init\+\_\+ctx}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}key)
\begin{DoxyCompactList}\small\item\em Initializes an AES context with a given key. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8h_a99d17d22ed909bd155007cdece29263a}{AES\+\_\+init\+\_\+ctx\+\_\+iv}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}key, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}iv)
\begin{DoxyCompactList}\small\item\em Initializes an AES context with a given key and IV. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8h_afbdec54757622549b63838ea2fbc3cf6}{AES\+\_\+ctx\+\_\+set\+\_\+iv}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}iv)
\begin{DoxyCompactList}\small\item\em Sets the IV in an existing AES context. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8h_abbe38e5c8a65203e1c81751e86f7b691}{AES\+\_\+\+ECB\+\_\+encrypt}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}buf)
\begin{DoxyCompactList}\small\item\em Encrypts a single block using ECB mode. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8h_afe44b8e0e4e6809d69ebdb5d24811728}{AES\+\_\+\+ECB\+\_\+decrypt}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}buf)
\begin{DoxyCompactList}\small\item\em Decrypts a single block using ECB mode. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8h_aeccef1909c8c9668e09db27d9d0e439f}{AES\+\_\+\+CBC\+\_\+encrypt\+\_\+buffer}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}buf, uint32\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Encrypts a buffer using CBC mode. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8h_a075ca81a07881b319c814bedb8b58f51}{AES\+\_\+\+CBC\+\_\+decrypt\+\_\+buffer}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}buf, uint32\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Decrypts a buffer using CBC mode. \end{DoxyCompactList}\item 
void \doxymbox{\hyperlink{aes_8h_a4c7968d6e1646ac3bbc0b10ad9c72b7d}{AES\+\_\+\+CTR\+\_\+xcrypt\+\_\+buffer}} (struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}ctx, uint8\+\_\+t \texorpdfstring{$\ast$}{*}buf, uint32\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Encrypts/\+decrypts a buffer using CTR mode. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
AES algorithm implementation (ECB, CTR, CBC modes). 



\label{doc-func-members}
\Hypertarget{aes_8h_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{aes_8h_a075ca81a07881b319c814bedb8b58f51}\index{aes.h@{aes.h}!AES\_CBC\_decrypt\_buffer@{AES\_CBC\_decrypt\_buffer}}
\index{AES\_CBC\_decrypt\_buffer@{AES\_CBC\_decrypt\_buffer}!aes.h@{aes.h}}
\doxysubsubsection{\texorpdfstring{AES\_CBC\_decrypt\_buffer()}{AES\_CBC\_decrypt\_buffer()}}
{\footnotesize\ttfamily \label{aes_8h_a075ca81a07881b319c814bedb8b58f51} 
void AES\+\_\+\+CBC\+\_\+decrypt\+\_\+buffer (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{, }\item[{uint32\+\_\+t}]{length}{}\end{DoxyParamCaption})}



Decrypts a buffer using CBC mode. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em buf} & Pointer to the data buffer. \\
\hline
{\em length} & Length of the buffer in bytes (must be a multiple of AES\+\_\+\+BLOCKLEN). \\
\hline
\end{DoxyParams}
\Hypertarget{aes_8h_aeccef1909c8c9668e09db27d9d0e439f}\index{aes.h@{aes.h}!AES\_CBC\_encrypt\_buffer@{AES\_CBC\_encrypt\_buffer}}
\index{AES\_CBC\_encrypt\_buffer@{AES\_CBC\_encrypt\_buffer}!aes.h@{aes.h}}
\doxysubsubsection{\texorpdfstring{AES\_CBC\_encrypt\_buffer()}{AES\_CBC\_encrypt\_buffer()}}
{\footnotesize\ttfamily \label{aes_8h_aeccef1909c8c9668e09db27d9d0e439f} 
void AES\+\_\+\+CBC\+\_\+encrypt\+\_\+buffer (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{, }\item[{uint32\+\_\+t}]{length}{}\end{DoxyParamCaption})}



Encrypts a buffer using CBC mode. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em buf} & Pointer to the data buffer. \\
\hline
{\em length} & Length of the buffer in bytes (must be a multiple of AES\+\_\+\+BLOCKLEN). \\
\hline
\end{DoxyParams}
\Hypertarget{aes_8h_a4c7968d6e1646ac3bbc0b10ad9c72b7d}\index{aes.h@{aes.h}!AES\_CTR\_xcrypt\_buffer@{AES\_CTR\_xcrypt\_buffer}}
\index{AES\_CTR\_xcrypt\_buffer@{AES\_CTR\_xcrypt\_buffer}!aes.h@{aes.h}}
\doxysubsubsection{\texorpdfstring{AES\_CTR\_xcrypt\_buffer()}{AES\_CTR\_xcrypt\_buffer()}}
{\footnotesize\ttfamily \label{aes_8h_a4c7968d6e1646ac3bbc0b10ad9c72b7d} 
void AES\+\_\+\+CTR\+\_\+xcrypt\+\_\+buffer (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{, }\item[{uint32\+\_\+t}]{length}{}\end{DoxyParamCaption})}



Encrypts/\+decrypts a buffer using CTR mode. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em buf} & Pointer to the data buffer. \\
\hline
{\em length} & Length of the buffer in bytes. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
CTR mode is symmetrical; the same function is used for encryption and decryption. 
\end{DoxyNote}
\Hypertarget{aes_8h_afbdec54757622549b63838ea2fbc3cf6}\index{aes.h@{aes.h}!AES\_ctx\_set\_iv@{AES\_ctx\_set\_iv}}
\index{AES\_ctx\_set\_iv@{AES\_ctx\_set\_iv}!aes.h@{aes.h}}
\doxysubsubsection{\texorpdfstring{AES\_ctx\_set\_iv()}{AES\_ctx\_set\_iv()}}
{\footnotesize\ttfamily \label{aes_8h_afbdec54757622549b63838ea2fbc3cf6} 
void AES\+\_\+ctx\+\_\+set\+\_\+iv (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{iv}{}\end{DoxyParamCaption})}



Sets the IV in an existing AES context. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em iv} & Pointer to the new Initialization Vector. \\
\hline
\end{DoxyParams}
\Hypertarget{aes_8h_afe44b8e0e4e6809d69ebdb5d24811728}\index{aes.h@{aes.h}!AES\_ECB\_decrypt@{AES\_ECB\_decrypt}}
\index{AES\_ECB\_decrypt@{AES\_ECB\_decrypt}!aes.h@{aes.h}}
\doxysubsubsection{\texorpdfstring{AES\_ECB\_decrypt()}{AES\_ECB\_decrypt()}}
{\footnotesize\ttfamily \label{aes_8h_afe44b8e0e4e6809d69ebdb5d24811728} 
void AES\+\_\+\+ECB\+\_\+decrypt (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{}\end{DoxyParamCaption})}



Decrypts a single block using ECB mode. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em buf} & Pointer to the data block (AES\+\_\+\+BLOCKLEN bytes). \\
\hline
\end{DoxyParams}
\Hypertarget{aes_8h_abbe38e5c8a65203e1c81751e86f7b691}\index{aes.h@{aes.h}!AES\_ECB\_encrypt@{AES\_ECB\_encrypt}}
\index{AES\_ECB\_encrypt@{AES\_ECB\_encrypt}!aes.h@{aes.h}}
\doxysubsubsection{\texorpdfstring{AES\_ECB\_encrypt()}{AES\_ECB\_encrypt()}}
{\footnotesize\ttfamily \label{aes_8h_abbe38e5c8a65203e1c81751e86f7b691} 
void AES\+\_\+\+ECB\+\_\+encrypt (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{}\end{DoxyParamCaption})}



Encrypts a single block using ECB mode. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em buf} & Pointer to the data block (AES\+\_\+\+BLOCKLEN bytes). \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
ECB is considered insecure for most uses. 
\end{DoxyNote}
\Hypertarget{aes_8h_af6103754d8f46cb642b0041973e4102e}\index{aes.h@{aes.h}!AES\_init\_ctx@{AES\_init\_ctx}}
\index{AES\_init\_ctx@{AES\_init\_ctx}!aes.h@{aes.h}}
\doxysubsubsection{\texorpdfstring{AES\_init\_ctx()}{AES\_init\_ctx()}}
{\footnotesize\ttfamily \label{aes_8h_af6103754d8f46cb642b0041973e4102e} 
void AES\+\_\+init\+\_\+ctx (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{key}{}\end{DoxyParamCaption})}



Initializes an AES context with a given key. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em key} & Pointer to the key. \\
\hline
\end{DoxyParams}
\Hypertarget{aes_8h_a99d17d22ed909bd155007cdece29263a}\index{aes.h@{aes.h}!AES\_init\_ctx\_iv@{AES\_init\_ctx\_iv}}
\index{AES\_init\_ctx\_iv@{AES\_init\_ctx\_iv}!aes.h@{aes.h}}
\doxysubsubsection{\texorpdfstring{AES\_init\_ctx\_iv()}{AES\_init\_ctx\_iv()}}
{\footnotesize\ttfamily \label{aes_8h_a99d17d22ed909bd155007cdece29263a} 
void AES\+\_\+init\+\_\+ctx\+\_\+iv (\begin{DoxyParamCaption}\item[{struct \doxymbox{\hyperlink{struct_a_e_s__ctx}{AES\+\_\+ctx}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{key}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{iv}{}\end{DoxyParamCaption})}



Initializes an AES context with a given key and IV. 


\begin{DoxyParams}{Parameters}
{\em ctx} & Pointer to the AES context. \\
\hline
{\em key} & Pointer to the key. \\
\hline
{\em iv} & Pointer to the Initialization Vector. \\
\hline
\end{DoxyParams}
