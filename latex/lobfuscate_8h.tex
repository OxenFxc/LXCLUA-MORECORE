\doxysection{lobfuscate.\+h File Reference}
\hypertarget{lobfuscate_8h}{}\label{lobfuscate_8h}\index{lobfuscate.h@{lobfuscate.h}}


Control Flow Flattening Obfuscation for Lua bytecode.  


{\ttfamily \+\#include "{}lobject.\+h"{}}\newline
{\ttfamily \+\#include "{}lopcodes.\+h"{}}\newline
{\ttfamily \+\#include "{}lstate.\+h"{}}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \doxymbox{\hyperlink{struct_basic_block}{Basic\+Block}}
\begin{DoxyCompactList}\small\item\em Basic block structure. Represents a contiguous sequence of instructions with a single entry and exit. \end{DoxyCompactList}\item 
struct \doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}}
\begin{DoxyCompactList}\small\item\em Control Flow Flattening context. Stores all state information during the flattening process. \end{DoxyCompactList}\item 
struct \doxymbox{\hyperlink{struct_c_f_f_metadata}{CFFMetadata}}
\begin{DoxyCompactList}\small\item\em Flattening metadata. Information required to de-\/flatten or interpret the obfuscated code. \end{DoxyCompactList}\item 
struct \doxymbox{\hyperlink{struct_v_m_protect_context}{VMProtect\+Context}}
\begin{DoxyCompactList}\small\item\em VM Protection context. \end{DoxyCompactList}\item 
struct \doxymbox{\hyperlink{struct_v_m_state}{VMState}}
\begin{DoxyCompactList}\small\item\em VM Runtime state. \end{DoxyCompactList}\item 
struct \doxymbox{\hyperlink{struct_v_m_code_table}{VMCode\+Table}}
\begin{DoxyCompactList}\small\item\em \doxylink{union_node}{Node} in the global list of VM-\/protected code tables. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{lobfuscate_8h_a4436fce2683f5f72791623e154451429}\label{lobfuscate_8h_a4436fce2683f5f72791623e154451429} 
\+\#define {\bfseries VM\+\_\+\+MAP\+\_\+\+SIZE}~256
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_a619277737eb47e5b34943bde3a8cc2f4}{VM\+\_\+\+MAKE\+\_\+\+INST}}(op,  a,  b,  c,  flags)
\begin{DoxyCompactList}\small\item\em Constructs a VM instruction. \end{DoxyCompactList}\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_ab00a98712b1e16b61530015d4de04bb9}{VM\+\_\+\+MAKE\+\_\+\+INST\+\_\+\+BX}}(op,  a,  bx)
\end{DoxyCompactItemize}
\begin{Indent}\textbf{ Obfuscation Mode Flags}\par
\begin{DoxyCompactItemize}
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_a88493920ab2c9c0b477b67a4493e64b5}{OBFUSCATE\+\_\+\+NONE}}~0
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_acbc671676a982aaf7f2631d03acec3dc}{OBFUSCATE\+\_\+\+CFF}}~(1$<$$<$0)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_a65796a9a1248ee3ba73babb85c20252a}{OBFUSCATE\+\_\+\+BLOCK\+\_\+\+SHUFFLE}}~(1$<$$<$1)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_a5f45a75132b02ae112641507e24e3715}{OBFUSCATE\+\_\+\+BOGUS\+\_\+\+BLOCKS}}~(1$<$$<$2)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_abec68ca2b424a6ba56d0cc26d722e3e6}{OBFUSCATE\+\_\+\+STATE\+\_\+\+ENCODE}}~(1$<$$<$3)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_a808fbbef8275ce3c96056482793dec3c}{OBFUSCATE\+\_\+\+NESTED\+\_\+\+DISPATCHER}}~(1$<$$<$4)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_acc74614f52615b510a859724d4e620e1}{OBFUSCATE\+\_\+\+OPAQUE\+\_\+\+PREDICATES}}~(1$<$$<$5)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_a6f7db3e8027ecf9ca30e5082be8e2960}{OBFUSCATE\+\_\+\+FUNC\+\_\+\+INTERLEAVE}}~(1$<$$<$6)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_a50bd92fe1bfef7f5c71ddba8955f1e7d}{OBFUSCATE\+\_\+\+VM\+\_\+\+PROTECT}}~(1$<$$<$7)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_a0aeb85db39df6e8a5b9eb8660eadc6e9}{OBFUSCATE\+\_\+\+BINARY\+\_\+\+DISPATCHER}}~(1$<$$<$8)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_a0933ea77b1c2bd184934aae19fee2d10}{OBFUSCATE\+\_\+\+RANDOM\+\_\+\+NOP}}~(1$<$$<$9)
\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ VM Instruction Field Macros}\par
\begin{DoxyCompactItemize}
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_a22846a77749f925dc65af6bccf4a018a}{VM\+\_\+\+GET\+\_\+\+OP}}(inst)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_ac536ab018a8f90729ea6951d769e67bd}{VM\+\_\+\+GET\+\_\+A}}(inst)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_aa24920add24bb9d7c7b32260246fc2d0}{VM\+\_\+\+GET\+\_\+B}}(inst)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_a8bd96be0cede37f74d6be96929a19e8b}{VM\+\_\+\+GET\+\_\+C}}(inst)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_ad0127835cc01b2796e79abedc86403f9}{VM\+\_\+\+GET\+\_\+\+Bx}}(inst)
\item 
\+\#define \doxymbox{\hyperlink{lobfuscate_8h_ae660a7c06cc8078ffa2dd51487dd3e26}{VM\+\_\+\+GET\+\_\+\+FLAGS}}(inst)
\end{DoxyCompactItemize}
\end{Indent}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{lobfuscate_8h_a8d439e456844ab683f027493f81cb92b}\label{lobfuscate_8h_a8d439e456844ab683f027493f81cb92b} 
typedef struct Basic\+Block {\bfseries Basic\+Block}
\begin{DoxyCompactList}\small\item\em Basic block structure. Represents a contiguous sequence of instructions with a single entry and exit. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_ab2ad6f422adb4d35d870cc877f2f5a9d}\label{lobfuscate_8h_ab2ad6f422adb4d35d870cc877f2f5a9d} 
typedef struct CFFContext {\bfseries CFFContext}
\begin{DoxyCompactList}\small\item\em Control Flow Flattening context. Stores all state information during the flattening process. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_a512a024cc7dac28cfa6eed05fc65fe2a}\label{lobfuscate_8h_a512a024cc7dac28cfa6eed05fc65fe2a} 
typedef struct CFFMetadata {\bfseries CFFMetadata}
\begin{DoxyCompactList}\small\item\em Flattening metadata. Information required to de-\/flatten or interpret the obfuscated code. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_a46a21cfa802a0115cc8dac6e80a7223e}\label{lobfuscate_8h_a46a21cfa802a0115cc8dac6e80a7223e} 
typedef uint64\+\_\+t {\bfseries VMInstruction}
\begin{DoxyCompactList}\small\item\em VM instruction type (64-\/bit). \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_a52fdda2ac933355a47105aa96aeb8a0a}\label{lobfuscate_8h_a52fdda2ac933355a47105aa96aeb8a0a} 
typedef struct VMProtect\+Context {\bfseries VMProtect\+Context}
\begin{DoxyCompactList}\small\item\em VM Protection context. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_aa6781d8dc86f6ccc1ad6124506a506e8}\label{lobfuscate_8h_aa6781d8dc86f6ccc1ad6124506a506e8} 
typedef struct VMState {\bfseries VMState}
\begin{DoxyCompactList}\small\item\em VM Runtime state. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_a60a9276e825b4200d951b86bfad8120b}\label{lobfuscate_8h_a60a9276e825b4200d951b86bfad8120b} 
typedef struct VMCode\+Table {\bfseries VMCode\+Table}
\begin{DoxyCompactList}\small\item\em \doxylink{union_node}{Node} in the global list of VM-\/protected code tables. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \doxymbox{\hyperlink{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534}{Opaque\+Predicate\+Type}} \{ \doxymbox{\hyperlink{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534a91c0340151042c06ce585f302c1e3f04}{OP\+\_\+\+ALWAYS\+\_\+\+TRUE}}
, \doxymbox{\hyperlink{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534abc907fe0647ce270edc4737c1a93f949}{OP\+\_\+\+ALWAYS\+\_\+\+FALSE}}
 \}
\begin{DoxyCompactList}\small\item\em Opaque predicate type. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_ad2f9a3fb1b403aa84da41b2a0bdf9eb1}\label{lobfuscate_8h_ad2f9a3fb1b403aa84da41b2a0bdf9eb1} 
enum \doxymbox{\hyperlink{lobfuscate_8h_ad2f9a3fb1b403aa84da41b2a0bdf9eb1}{VMOp\+Code}} \{ \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+NOP} = 0
, {\bfseries VM\+\_\+\+OP\+\_\+\+LOAD}
, {\bfseries VM\+\_\+\+OP\+\_\+\+MOVE}
, {\bfseries VM\+\_\+\+OP\+\_\+\+STORE}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+ADD}
, {\bfseries VM\+\_\+\+OP\+\_\+\+SUB}
, {\bfseries VM\+\_\+\+OP\+\_\+\+MUL}
, {\bfseries VM\+\_\+\+OP\+\_\+\+DIV}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+MOD}
, {\bfseries VM\+\_\+\+OP\+\_\+\+POW}
, {\bfseries VM\+\_\+\+OP\+\_\+\+UNM}
, {\bfseries VM\+\_\+\+OP\+\_\+\+IDIV}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+BAND}
, {\bfseries VM\+\_\+\+OP\+\_\+\+BOR}
, {\bfseries VM\+\_\+\+OP\+\_\+\+BXOR}
, {\bfseries VM\+\_\+\+OP\+\_\+\+BNOT}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+SHL}
, {\bfseries VM\+\_\+\+OP\+\_\+\+SHR}
, {\bfseries VM\+\_\+\+OP\+\_\+\+JMP}
, {\bfseries VM\+\_\+\+OP\+\_\+\+JEQ}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+JNE}
, {\bfseries VM\+\_\+\+OP\+\_\+\+JLT}
, {\bfseries VM\+\_\+\+OP\+\_\+\+JLE}
, {\bfseries VM\+\_\+\+OP\+\_\+\+JGT}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+JGE}
, {\bfseries VM\+\_\+\+OP\+\_\+\+CALL}
, {\bfseries VM\+\_\+\+OP\+\_\+\+RET}
, {\bfseries VM\+\_\+\+OP\+\_\+\+TAILCALL}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+NEWTABLE}
, {\bfseries VM\+\_\+\+OP\+\_\+\+GETTABLE}
, {\bfseries VM\+\_\+\+OP\+\_\+\+SETTABLE}
, {\bfseries VM\+\_\+\+OP\+\_\+\+GETFIELD}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+SETFIELD}
, {\bfseries VM\+\_\+\+OP\+\_\+\+GETI}
, {\bfseries VM\+\_\+\+OP\+\_\+\+SETI}
, {\bfseries VM\+\_\+\+OP\+\_\+\+GETTABUP}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+SETTABUP}
, {\bfseries VM\+\_\+\+OP\+\_\+\+CLOSURE}
, {\bfseries VM\+\_\+\+OP\+\_\+\+GETUPVAL}
, {\bfseries VM\+\_\+\+OP\+\_\+\+SETUPVAL}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+CONCAT}
, {\bfseries VM\+\_\+\+OP\+\_\+\+LEN}
, {\bfseries VM\+\_\+\+OP\+\_\+\+NOT}
, {\bfseries VM\+\_\+\+OP\+\_\+\+TEST}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+TESTSET}
, {\bfseries VM\+\_\+\+OP\+\_\+\+FORLOOP}
, {\bfseries VM\+\_\+\+OP\+\_\+\+FORPREP}
, {\bfseries VM\+\_\+\+OP\+\_\+\+TFORPREP}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+TFORCALL}
, {\bfseries VM\+\_\+\+OP\+\_\+\+TFORLOOP}
, {\bfseries VM\+\_\+\+OP\+\_\+\+VARARG}
, {\bfseries VM\+\_\+\+OP\+\_\+\+VARARGPREP}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+SELF}
, {\bfseries VM\+\_\+\+OP\+\_\+\+SETLIST}
, {\bfseries VM\+\_\+\+OP\+\_\+\+LOADKX}
, {\bfseries VM\+\_\+\+OP\+\_\+\+LOADFALSE}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+LOADTRUE}
, {\bfseries VM\+\_\+\+OP\+\_\+\+LOADNIL}
, {\bfseries VM\+\_\+\+OP\+\_\+\+MMBIN}
, {\bfseries VM\+\_\+\+OP\+\_\+\+MMBINI}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+MMBINK}
, {\bfseries VM\+\_\+\+OP\+\_\+\+EXT1}
, {\bfseries VM\+\_\+\+OP\+\_\+\+EXT2}
, {\bfseries VM\+\_\+\+OP\+\_\+\+HALT}
, \newline
{\bfseries VM\+\_\+\+OP\+\_\+\+COUNT}
 \}
\begin{DoxyCompactList}\small\item\em Custom VM opcodes. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_a08382105422a07372cea252f4e9b7b1d}{lua\+O\+\_\+flatten}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, \doxymbox{\hyperlink{struct_proto}{Proto}} \texorpdfstring{$\ast$}{*}f, int flags, unsigned int seed, const char \texorpdfstring{$\ast$}{*}log\+\_\+path)
\begin{DoxyCompactList}\small\item\em Applies control flow flattening to a function prototype. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_aadfdcce31b2ed1398b58f391b507b247}{lua\+O\+\_\+unflatten}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, \doxymbox{\hyperlink{struct_proto}{Proto}} \texorpdfstring{$\ast$}{*}f, \doxymbox{\hyperlink{struct_c_f_f_metadata}{CFFMetadata}} \texorpdfstring{$\ast$}{*}metadata)
\begin{DoxyCompactList}\small\item\em Reverses control flow flattening. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_a737a42bcf0da54a52f38a3346262c3fc}{lua\+O\+\_\+serialize\+Metadata}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, \doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}ctx, void \texorpdfstring{$\ast$}{*}buffer, size\+\_\+t \texorpdfstring{$\ast$}{*}size)
\begin{DoxyCompactList}\small\item\em Serializes flattening metadata for storage. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_af9f3c9a0ded7c2180f7e1ccec82f031d}{lua\+O\+\_\+deserialize\+Metadata}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, const void \texorpdfstring{$\ast$}{*}buffer, size\+\_\+t size, \doxymbox{\hyperlink{struct_c_f_f_metadata}{CFFMetadata}} \texorpdfstring{$\ast$}{*}metadata)
\begin{DoxyCompactList}\small\item\em Deserializes flattening metadata. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC void \doxymbox{\hyperlink{lobfuscate_8h_afc2a08274c6ac8497277cfe08d0e7473}{lua\+O\+\_\+free\+Metadata}} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, \doxymbox{\hyperlink{struct_c_f_f_metadata}{CFFMetadata}} \texorpdfstring{$\ast$}{*}metadata)
\begin{DoxyCompactList}\small\item\em Frees allocated metadata. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_af9480cb85330430997eee5affa96d5c8}{lua\+O\+\_\+identify\+Blocks}} (\doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}ctx)
\begin{DoxyCompactList}\small\item\em Identifies basic blocks in the function code. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_a6ef5018a88ffab9c5f5d288f6a74d9f2}{lua\+O\+\_\+is\+Block\+Terminator}} (Op\+Code op)
\begin{DoxyCompactList}\small\item\em Checks if an opcode terminates a basic block. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_a0d6dabaf9252ea78e2b4a9bc4be129f1}{lua\+O\+\_\+is\+Jump\+Instruction}} (Op\+Code op)
\begin{DoxyCompactList}\small\item\em Checks if an opcode is a jump instruction. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_a281f7d60aebebe1c6a9b30ea4340aae3}{lua\+O\+\_\+get\+Jump\+Target}} (Instruction inst, int pc)
\begin{DoxyCompactList}\small\item\em Gets the target PC of a jump instruction. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_aad2643292effded4bc9e7a8f68f3ee0b}{lua\+O\+\_\+generate\+Dispatcher}} (\doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}ctx)
\begin{DoxyCompactList}\small\item\em Generates the dispatcher code. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC void \doxymbox{\hyperlink{lobfuscate_8h_ab8bc2edf07a551a9fd6d59225e2eb781}{lua\+O\+\_\+shuffle\+Blocks}} (\doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}ctx)
\begin{DoxyCompactList}\small\item\em Shuffles basic block order. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_a92fbd80b6b20e969c61111b856087ff2}{lua\+O\+\_\+encode\+State}} (int state, unsigned int seed)
\begin{DoxyCompactList}\small\item\em Encodes a state value. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_afefc75bf81b33b6eebc9abe5adb9f685}{lua\+O\+\_\+decode\+State}} (int encoded\+\_\+state, unsigned int seed)
\begin{DoxyCompactList}\small\item\em Decodes an encoded state value. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC Instruction \doxymbox{\hyperlink{lobfuscate_8h_a2d03df7778da6a7d3410d3716f849c8a}{lua\+O\+\_\+create\+NOP}} (unsigned int seed)
\begin{DoxyCompactList}\small\item\em Creates a NOP instruction with fake parameters. \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_ac82a9fa198a5103105d3aebe7652249c}{lua\+O\+\_\+generate\+Nested\+Dispatcher}} (\doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}ctx)
\begin{DoxyCompactList}\small\item\em Generates a nested dispatcher (multi-\/layered state machine). \end{DoxyCompactList}\item 
LUAI\+\_\+\+FUNC int \doxymbox{\hyperlink{lobfuscate_8h_a55a1d3b9b62baaddb55706c2a6c4a75b}{lua\+O\+\_\+emit\+Opaque\+Predicate}} (\doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}ctx, \doxymbox{\hyperlink{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534}{Opaque\+Predicate\+Type}} type, unsigned int \texorpdfstring{$\ast$}{*}seed)
\begin{DoxyCompactList}\small\item\em Emits an opaque predicate into the code. \end{DoxyCompactList}\end{DoxyCompactItemize}
\begin{Indent}\textbf{ VM Protection API}\par
\begin{DoxyCompactItemize}
\item 
\Hypertarget{lobfuscate_8h_a69413829b3d34e00cf2f909a2f154085}\label{lobfuscate_8h_a69413829b3d34e00cf2f909a2f154085} 
LUAI\+\_\+\+FUNC \doxymbox{\hyperlink{struct_v_m_code_table}{VMCode\+Table}} \texorpdfstring{$\ast$}{*} {\bfseries lua\+O\+\_\+register\+VMCode} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, struct \doxymbox{\hyperlink{struct_proto}{Proto}} \texorpdfstring{$\ast$}{*}p, \doxymbox{\hyperlink{lobfuscate_8h_a46a21cfa802a0115cc8dac6e80a7223e}{VMInstruction}} \texorpdfstring{$\ast$}{*}code, int size, uint64\+\_\+t key, int \texorpdfstring{$\ast$}{*}reverse\+\_\+map, unsigned int seed)
\begin{DoxyCompactList}\small\item\em Registers VM code in the global list. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_aeaafa8bb445d30e0c602e859c7bbfc7d}\label{lobfuscate_8h_aeaafa8bb445d30e0c602e859c7bbfc7d} 
LUAI\+\_\+\+FUNC \doxymbox{\hyperlink{struct_v_m_code_table}{VMCode\+Table}} \texorpdfstring{$\ast$}{*} {\bfseries lua\+O\+\_\+find\+VMCode} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, struct \doxymbox{\hyperlink{struct_proto}{Proto}} \texorpdfstring{$\ast$}{*}p)
\begin{DoxyCompactList}\small\item\em Finds registered VM code for a prototype. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_a53036c494910ecedbb1200b69e9c7ecb}\label{lobfuscate_8h_a53036c494910ecedbb1200b69e9c7ecb} 
LUAI\+\_\+\+FUNC void {\bfseries lua\+O\+\_\+free\+All\+VMCode} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L)
\begin{DoxyCompactList}\small\item\em Frees all registered VM code tables. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_a54ca82991a476df8bfdce3f7b513a1b1}\label{lobfuscate_8h_a54ca82991a476df8bfdce3f7b513a1b1} 
LUAI\+\_\+\+FUNC \doxymbox{\hyperlink{struct_v_m_protect_context}{VMProtect\+Context}} \texorpdfstring{$\ast$}{*} {\bfseries lua\+O\+\_\+init\+VMContext} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, \doxymbox{\hyperlink{struct_proto}{Proto}} \texorpdfstring{$\ast$}{*}f, unsigned int seed)
\begin{DoxyCompactList}\small\item\em Initializes VM protection context. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_a4e7e3b84d53b9c785c062352db0f24f4}\label{lobfuscate_8h_a4e7e3b84d53b9c785c062352db0f24f4} 
LUAI\+\_\+\+FUNC void {\bfseries lua\+O\+\_\+free\+VMContext} (\doxymbox{\hyperlink{struct_v_m_protect_context}{VMProtect\+Context}} \texorpdfstring{$\ast$}{*}ctx)
\begin{DoxyCompactList}\small\item\em Frees VM protection context. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_a29066d2265d9afbf56044d8c93cd8f13}\label{lobfuscate_8h_a29066d2265d9afbf56044d8c93cd8f13} 
LUAI\+\_\+\+FUNC int {\bfseries lua\+O\+\_\+convert\+To\+VM} (\doxymbox{\hyperlink{struct_v_m_protect_context}{VMProtect\+Context}} \texorpdfstring{$\ast$}{*}ctx)
\begin{DoxyCompactList}\small\item\em Translates Lua bytecode to custom VM instructions. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_a0b1ec7fe37c061f6d390667e13fd0027}\label{lobfuscate_8h_a0b1ec7fe37c061f6d390667e13fd0027} 
LUAI\+\_\+\+FUNC int {\bfseries lua\+O\+\_\+execute\+VM} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, \doxymbox{\hyperlink{struct_proto}{Proto}} \texorpdfstring{$\ast$}{*}f)
\begin{DoxyCompactList}\small\item\em Executes VM-\/protected code. \end{DoxyCompactList}\item 
\Hypertarget{lobfuscate_8h_a051666cef492789cc99f848006e60f57}\label{lobfuscate_8h_a051666cef492789cc99f848006e60f57} 
LUAI\+\_\+\+FUNC int {\bfseries lua\+O\+\_\+vm\+Protect} (\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}L, \doxymbox{\hyperlink{struct_proto}{Proto}} \texorpdfstring{$\ast$}{*}f, unsigned int seed)
\begin{DoxyCompactList}\small\item\em Applies VM protection to a function prototype. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}


\doxysubsection{Detailed Description}
Control Flow Flattening Obfuscation for Lua bytecode. 

This module provides various obfuscation techniques for Lua bytecode, including control flow flattening, block shuffling, bogus block insertion, and VM protection. 

\label{doc-define-members}
\Hypertarget{lobfuscate_8h_doc-define-members}
\doxysubsection{Macro Definition Documentation}
\Hypertarget{lobfuscate_8h_a0aeb85db39df6e8a5b9eb8660eadc6e9}\index{lobfuscate.h@{lobfuscate.h}!OBFUSCATE\_BINARY\_DISPATCHER@{OBFUSCATE\_BINARY\_DISPATCHER}}
\index{OBFUSCATE\_BINARY\_DISPATCHER@{OBFUSCATE\_BINARY\_DISPATCHER}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OBFUSCATE\_BINARY\_DISPATCHER}{OBFUSCATE\_BINARY\_DISPATCHER}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a0aeb85db39df6e8a5b9eb8660eadc6e9} 
\+\#define OBFUSCATE\+\_\+\+BINARY\+\_\+\+DISPATCHER~(1$<$$<$8)}

Binary search dispatcher. \Hypertarget{lobfuscate_8h_a65796a9a1248ee3ba73babb85c20252a}\index{lobfuscate.h@{lobfuscate.h}!OBFUSCATE\_BLOCK\_SHUFFLE@{OBFUSCATE\_BLOCK\_SHUFFLE}}
\index{OBFUSCATE\_BLOCK\_SHUFFLE@{OBFUSCATE\_BLOCK\_SHUFFLE}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OBFUSCATE\_BLOCK\_SHUFFLE}{OBFUSCATE\_BLOCK\_SHUFFLE}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a65796a9a1248ee3ba73babb85c20252a} 
\+\#define OBFUSCATE\+\_\+\+BLOCK\+\_\+\+SHUFFLE~(1$<$$<$1)}

Randomize basic block order. \Hypertarget{lobfuscate_8h_a5f45a75132b02ae112641507e24e3715}\index{lobfuscate.h@{lobfuscate.h}!OBFUSCATE\_BOGUS\_BLOCKS@{OBFUSCATE\_BOGUS\_BLOCKS}}
\index{OBFUSCATE\_BOGUS\_BLOCKS@{OBFUSCATE\_BOGUS\_BLOCKS}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OBFUSCATE\_BOGUS\_BLOCKS}{OBFUSCATE\_BOGUS\_BLOCKS}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a5f45a75132b02ae112641507e24e3715} 
\+\#define OBFUSCATE\+\_\+\+BOGUS\+\_\+\+BLOCKS~(1$<$$<$2)}

Insert bogus basic blocks. \Hypertarget{lobfuscate_8h_acbc671676a982aaf7f2631d03acec3dc}\index{lobfuscate.h@{lobfuscate.h}!OBFUSCATE\_CFF@{OBFUSCATE\_CFF}}
\index{OBFUSCATE\_CFF@{OBFUSCATE\_CFF}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OBFUSCATE\_CFF}{OBFUSCATE\_CFF}}
{\footnotesize\ttfamily \label{lobfuscate_8h_acbc671676a982aaf7f2631d03acec3dc} 
\+\#define OBFUSCATE\+\_\+\+CFF~(1$<$$<$0)}

Control flow flattening. \Hypertarget{lobfuscate_8h_a6f7db3e8027ecf9ca30e5082be8e2960}\index{lobfuscate.h@{lobfuscate.h}!OBFUSCATE\_FUNC\_INTERLEAVE@{OBFUSCATE\_FUNC\_INTERLEAVE}}
\index{OBFUSCATE\_FUNC\_INTERLEAVE@{OBFUSCATE\_FUNC\_INTERLEAVE}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OBFUSCATE\_FUNC\_INTERLEAVE}{OBFUSCATE\_FUNC\_INTERLEAVE}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a6f7db3e8027ecf9ca30e5082be8e2960} 
\+\#define OBFUSCATE\+\_\+\+FUNC\+\_\+\+INTERLEAVE~(1$<$$<$6)}

Function interleaving (fake function paths). \Hypertarget{lobfuscate_8h_a808fbbef8275ce3c96056482793dec3c}\index{lobfuscate.h@{lobfuscate.h}!OBFUSCATE\_NESTED\_DISPATCHER@{OBFUSCATE\_NESTED\_DISPATCHER}}
\index{OBFUSCATE\_NESTED\_DISPATCHER@{OBFUSCATE\_NESTED\_DISPATCHER}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OBFUSCATE\_NESTED\_DISPATCHER}{OBFUSCATE\_NESTED\_DISPATCHER}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a808fbbef8275ce3c96056482793dec3c} 
\+\#define OBFUSCATE\+\_\+\+NESTED\+\_\+\+DISPATCHER~(1$<$$<$4)}

Multi-\/layered dispatcher. \Hypertarget{lobfuscate_8h_a88493920ab2c9c0b477b67a4493e64b5}\index{lobfuscate.h@{lobfuscate.h}!OBFUSCATE\_NONE@{OBFUSCATE\_NONE}}
\index{OBFUSCATE\_NONE@{OBFUSCATE\_NONE}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OBFUSCATE\_NONE}{OBFUSCATE\_NONE}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a88493920ab2c9c0b477b67a4493e64b5} 
\+\#define OBFUSCATE\+\_\+\+NONE~0}

No obfuscation. \Hypertarget{lobfuscate_8h_acc74614f52615b510a859724d4e620e1}\index{lobfuscate.h@{lobfuscate.h}!OBFUSCATE\_OPAQUE\_PREDICATES@{OBFUSCATE\_OPAQUE\_PREDICATES}}
\index{OBFUSCATE\_OPAQUE\_PREDICATES@{OBFUSCATE\_OPAQUE\_PREDICATES}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OBFUSCATE\_OPAQUE\_PREDICATES}{OBFUSCATE\_OPAQUE\_PREDICATES}}
{\footnotesize\ttfamily \label{lobfuscate_8h_acc74614f52615b510a859724d4e620e1} 
\+\#define OBFUSCATE\+\_\+\+OPAQUE\+\_\+\+PREDICATES~(1$<$$<$5)}

Opaque predicates (always true/\+false conditions). \Hypertarget{lobfuscate_8h_a0933ea77b1c2bd184934aae19fee2d10}\index{lobfuscate.h@{lobfuscate.h}!OBFUSCATE\_RANDOM\_NOP@{OBFUSCATE\_RANDOM\_NOP}}
\index{OBFUSCATE\_RANDOM\_NOP@{OBFUSCATE\_RANDOM\_NOP}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OBFUSCATE\_RANDOM\_NOP}{OBFUSCATE\_RANDOM\_NOP}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a0933ea77b1c2bd184934aae19fee2d10} 
\+\#define OBFUSCATE\+\_\+\+RANDOM\+\_\+\+NOP~(1$<$$<$9)}

Insert random NOP instructions. \Hypertarget{lobfuscate_8h_abec68ca2b424a6ba56d0cc26d722e3e6}\index{lobfuscate.h@{lobfuscate.h}!OBFUSCATE\_STATE\_ENCODE@{OBFUSCATE\_STATE\_ENCODE}}
\index{OBFUSCATE\_STATE\_ENCODE@{OBFUSCATE\_STATE\_ENCODE}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OBFUSCATE\_STATE\_ENCODE}{OBFUSCATE\_STATE\_ENCODE}}
{\footnotesize\ttfamily \label{lobfuscate_8h_abec68ca2b424a6ba56d0cc26d722e3e6} 
\+\#define OBFUSCATE\+\_\+\+STATE\+\_\+\+ENCODE~(1$<$$<$3)}

Obfuscate state variable values. \Hypertarget{lobfuscate_8h_a50bd92fe1bfef7f5c71ddba8955f1e7d}\index{lobfuscate.h@{lobfuscate.h}!OBFUSCATE\_VM\_PROTECT@{OBFUSCATE\_VM\_PROTECT}}
\index{OBFUSCATE\_VM\_PROTECT@{OBFUSCATE\_VM\_PROTECT}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OBFUSCATE\_VM\_PROTECT}{OBFUSCATE\_VM\_PROTECT}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a50bd92fe1bfef7f5c71ddba8955f1e7d} 
\+\#define OBFUSCATE\+\_\+\+VM\+\_\+\+PROTECT~(1$<$$<$7)}

VM protection (custom instruction set). \Hypertarget{lobfuscate_8h_ac536ab018a8f90729ea6951d769e67bd}\index{lobfuscate.h@{lobfuscate.h}!VM\_GET\_A@{VM\_GET\_A}}
\index{VM\_GET\_A@{VM\_GET\_A}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{VM\_GET\_A}{VM\_GET\_A}}
{\footnotesize\ttfamily \label{lobfuscate_8h_ac536ab018a8f90729ea6951d769e67bd} 
\+\#define VM\+\_\+\+GET\+\_\+A(\begin{DoxyParamCaption}\item[{}]{inst}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{((int)(((inst)\ >>\ 8)\ \&\ 0xFFFF))}

\end{DoxyCode}
\Hypertarget{lobfuscate_8h_aa24920add24bb9d7c7b32260246fc2d0}\index{lobfuscate.h@{lobfuscate.h}!VM\_GET\_B@{VM\_GET\_B}}
\index{VM\_GET\_B@{VM\_GET\_B}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{VM\_GET\_B}{VM\_GET\_B}}
{\footnotesize\ttfamily \label{lobfuscate_8h_aa24920add24bb9d7c7b32260246fc2d0} 
\+\#define VM\+\_\+\+GET\+\_\+B(\begin{DoxyParamCaption}\item[{}]{inst}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{((int)(((inst)\ >>\ 24)\ \&\ 0xFFFF))}

\end{DoxyCode}
\Hypertarget{lobfuscate_8h_ad0127835cc01b2796e79abedc86403f9}\index{lobfuscate.h@{lobfuscate.h}!VM\_GET\_Bx@{VM\_GET\_Bx}}
\index{VM\_GET\_Bx@{VM\_GET\_Bx}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{VM\_GET\_Bx}{VM\_GET\_Bx}}
{\footnotesize\ttfamily \label{lobfuscate_8h_ad0127835cc01b2796e79abedc86403f9} 
\+\#define VM\+\_\+\+GET\+\_\+\+Bx(\begin{DoxyParamCaption}\item[{}]{inst}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{((int64\_t)(((inst)\ >>\ 24)\ \&\ 0xFFFFFFFFFFULL))}

\end{DoxyCode}
\Hypertarget{lobfuscate_8h_a8bd96be0cede37f74d6be96929a19e8b}\index{lobfuscate.h@{lobfuscate.h}!VM\_GET\_C@{VM\_GET\_C}}
\index{VM\_GET\_C@{VM\_GET\_C}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{VM\_GET\_C}{VM\_GET\_C}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a8bd96be0cede37f74d6be96929a19e8b} 
\+\#define VM\+\_\+\+GET\+\_\+C(\begin{DoxyParamCaption}\item[{}]{inst}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{((int)(((inst)\ >>\ 40)\ \&\ 0xFFFF))}

\end{DoxyCode}
\Hypertarget{lobfuscate_8h_ae660a7c06cc8078ffa2dd51487dd3e26}\index{lobfuscate.h@{lobfuscate.h}!VM\_GET\_FLAGS@{VM\_GET\_FLAGS}}
\index{VM\_GET\_FLAGS@{VM\_GET\_FLAGS}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{VM\_GET\_FLAGS}{VM\_GET\_FLAGS}}
{\footnotesize\ttfamily \label{lobfuscate_8h_ae660a7c06cc8078ffa2dd51487dd3e26} 
\+\#define VM\+\_\+\+GET\+\_\+\+FLAGS(\begin{DoxyParamCaption}\item[{}]{inst}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{((int)(((inst)\ >>\ 56)\ \&\ 0xFF))}

\end{DoxyCode}
\Hypertarget{lobfuscate_8h_a22846a77749f925dc65af6bccf4a018a}\index{lobfuscate.h@{lobfuscate.h}!VM\_GET\_OP@{VM\_GET\_OP}}
\index{VM\_GET\_OP@{VM\_GET\_OP}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{VM\_GET\_OP}{VM\_GET\_OP}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a22846a77749f925dc65af6bccf4a018a} 
\+\#define VM\+\_\+\+GET\+\_\+\+OP(\begin{DoxyParamCaption}\item[{}]{inst}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{((int)((inst)\ \&\ 0xFF))}

\end{DoxyCode}
\Hypertarget{lobfuscate_8h_a619277737eb47e5b34943bde3a8cc2f4}\index{lobfuscate.h@{lobfuscate.h}!VM\_MAKE\_INST@{VM\_MAKE\_INST}}
\index{VM\_MAKE\_INST@{VM\_MAKE\_INST}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{VM\_MAKE\_INST}{VM\_MAKE\_INST}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a619277737eb47e5b34943bde3a8cc2f4} 
\+\#define VM\+\_\+\+MAKE\+\_\+\+INST(\begin{DoxyParamCaption}\item[{}]{op}{, }\item[{}]{a}{, }\item[{}]{b}{, }\item[{}]{c}{, }\item[{}]{flags}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{(((uint64\_t)(op)\ \&\ 0xFF)\ |\ \(\backslash\)}
\DoxyCodeLine{\ (((uint64\_t)(a)\ \&\ 0xFFFF)\ <<\ 8)\ |\ \(\backslash\)}
\DoxyCodeLine{\ (((uint64\_t)(b)\ \&\ 0xFFFF)\ <<\ 24)\ |\ \(\backslash\)}
\DoxyCodeLine{\ (((uint64\_t)(c)\ \&\ 0xFFFF)\ <<\ 40)\ |\ \(\backslash\)}
\DoxyCodeLine{\ (((uint64\_t)(flags)\ \&\ 0xFF)\ <<\ 56))}

\end{DoxyCode}


Constructs a VM instruction. 

\Hypertarget{lobfuscate_8h_ab00a98712b1e16b61530015d4de04bb9}\index{lobfuscate.h@{lobfuscate.h}!VM\_MAKE\_INST\_BX@{VM\_MAKE\_INST\_BX}}
\index{VM\_MAKE\_INST\_BX@{VM\_MAKE\_INST\_BX}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{VM\_MAKE\_INST\_BX}{VM\_MAKE\_INST\_BX}}
{\footnotesize\ttfamily \label{lobfuscate_8h_ab00a98712b1e16b61530015d4de04bb9} 
\+\#define VM\+\_\+\+MAKE\+\_\+\+INST\+\_\+\+BX(\begin{DoxyParamCaption}\item[{}]{op}{, }\item[{}]{a}{, }\item[{}]{bx}{}\end{DoxyParamCaption})}

{\bfseries Value:\+}
\begin{DoxyCode}{0}
\DoxyCodeLine{(((uint64\_t)(op)\ \&\ 0xFF)\ |\ \(\backslash\)}
\DoxyCodeLine{\ (((uint64\_t)(a)\ \&\ 0xFFFF)\ <<\ 8)\ |\ \(\backslash\)}
\DoxyCodeLine{\ (((uint64\_t)(bx)\ \&\ 0xFFFFFFFFFFULL)\ <<\ 24))}

\end{DoxyCode}


\label{doc-enum-members}
\Hypertarget{lobfuscate_8h_doc-enum-members}
\doxysubsection{Enumeration Type Documentation}
\Hypertarget{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534}\index{lobfuscate.h@{lobfuscate.h}!OpaquePredicateType@{OpaquePredicateType}}
\index{OpaquePredicateType@{OpaquePredicateType}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{OpaquePredicateType}{OpaquePredicateType}}
{\footnotesize\ttfamily \label{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534} 
enum \doxymbox{\hyperlink{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534}{Opaque\+Predicate\+Type}}}



Opaque predicate type. 

\begin{DoxyEnumFields}[2]{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{OP\_ALWAYS\_TRUE@{OP\_ALWAYS\_TRUE}!lobfuscate.h@{lobfuscate.h}}
\index{lobfuscate.h@{lobfuscate.h}!OP\_ALWAYS\_TRUE@{OP\_ALWAYS\_TRUE}}
}\Hypertarget{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534a91c0340151042c06ce585f302c1e3f04}\label{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534a91c0340151042c06ce585f302c1e3f04} 
OP\+\_\+\+ALWAYS\+\_\+\+TRUE&Always true. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{OP\_ALWAYS\_FALSE@{OP\_ALWAYS\_FALSE}!lobfuscate.h@{lobfuscate.h}}
\index{lobfuscate.h@{lobfuscate.h}!OP\_ALWAYS\_FALSE@{OP\_ALWAYS\_FALSE}}
}\Hypertarget{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534abc907fe0647ce270edc4737c1a93f949}\label{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534abc907fe0647ce270edc4737c1a93f949} 
OP\+\_\+\+ALWAYS\+\_\+\+FALSE&Always false. \\
\hline

\end{DoxyEnumFields}


\label{doc-func-members}
\Hypertarget{lobfuscate_8h_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{lobfuscate_8h_a2d03df7778da6a7d3410d3716f849c8a}\index{lobfuscate.h@{lobfuscate.h}!luaO\_createNOP@{luaO\_createNOP}}
\index{luaO\_createNOP@{luaO\_createNOP}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_createNOP()}{luaO\_createNOP()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a2d03df7778da6a7d3410d3716f849c8a} 
LUAI\+\_\+\+FUNC Instruction lua\+O\+\_\+create\+NOP (\begin{DoxyParamCaption}\item[{unsigned int}]{seed}{}\end{DoxyParamCaption})}



Creates a NOP instruction with fake parameters. 


\begin{DoxyParams}{Parameters}
{\em seed} & Random seed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Generated instruction. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_afefc75bf81b33b6eebc9abe5adb9f685}\index{lobfuscate.h@{lobfuscate.h}!luaO\_decodeState@{luaO\_decodeState}}
\index{luaO\_decodeState@{luaO\_decodeState}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_decodeState()}{luaO\_decodeState()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_afefc75bf81b33b6eebc9abe5adb9f685} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+decode\+State (\begin{DoxyParamCaption}\item[{int}]{encoded\+\_\+state}{, }\item[{unsigned int}]{seed}{}\end{DoxyParamCaption})}



Decodes an encoded state value. 


\begin{DoxyParams}{Parameters}
{\em encoded\+\_\+state} & Encoded value. \\
\hline
{\em seed} & Random seed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Original state ID. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_af9f3c9a0ded7c2180f7e1ccec82f031d}\index{lobfuscate.h@{lobfuscate.h}!luaO\_deserializeMetadata@{luaO\_deserializeMetadata}}
\index{luaO\_deserializeMetadata@{luaO\_deserializeMetadata}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_deserializeMetadata()}{luaO\_deserializeMetadata()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_af9f3c9a0ded7c2180f7e1ccec82f031d} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+deserialize\+Metadata (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{const void \texorpdfstring{$\ast$}{*}}]{buffer}{, }\item[{size\+\_\+t}]{size}{, }\item[{\doxymbox{\hyperlink{struct_c_f_f_metadata}{CFFMetadata}} \texorpdfstring{$\ast$}{*}}]{metadata}{}\end{DoxyParamCaption})}



Deserializes flattening metadata. 


\begin{DoxyParams}{Parameters}
{\em L} & Lua state. \\
\hline
{\em buffer} & Input buffer. \\
\hline
{\em size} & Buffer size. \\
\hline
{\em metadata} & Output metadata structure. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, error code on failure. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_a55a1d3b9b62baaddb55706c2a6c4a75b}\index{lobfuscate.h@{lobfuscate.h}!luaO\_emitOpaquePredicate@{luaO\_emitOpaquePredicate}}
\index{luaO\_emitOpaquePredicate@{luaO\_emitOpaquePredicate}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_emitOpaquePredicate()}{luaO\_emitOpaquePredicate()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a55a1d3b9b62baaddb55706c2a6c4a75b} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+emit\+Opaque\+Predicate (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{\doxymbox{\hyperlink{lobfuscate_8h_ab6c60e31d023b1f597254aa5e42a3534}{Opaque\+Predicate\+Type}}}]{type}{, }\item[{unsigned int \texorpdfstring{$\ast$}{*}}]{seed}{}\end{DoxyParamCaption})}



Emits an opaque predicate into the code. 


\begin{DoxyParams}{Parameters}
{\em ctx} & CFF context. \\
\hline
{\em type} & Predicate type. \\
\hline
{\em seed} & Random seed pointer (updated). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Number of instructions emitted, or -\/1 on failure. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_a92fbd80b6b20e969c61111b856087ff2}\index{lobfuscate.h@{lobfuscate.h}!luaO\_encodeState@{luaO\_encodeState}}
\index{luaO\_encodeState@{luaO\_encodeState}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_encodeState()}{luaO\_encodeState()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a92fbd80b6b20e969c61111b856087ff2} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+encode\+State (\begin{DoxyParamCaption}\item[{int}]{state}{, }\item[{unsigned int}]{seed}{}\end{DoxyParamCaption})}



Encodes a state value. 


\begin{DoxyParams}{Parameters}
{\em state} & Original state ID. \\
\hline
{\em seed} & Random seed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Encoded state value. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_a08382105422a07372cea252f4e9b7b1d}\index{lobfuscate.h@{lobfuscate.h}!luaO\_flatten@{luaO\_flatten}}
\index{luaO\_flatten@{luaO\_flatten}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_flatten()}{luaO\_flatten()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a08382105422a07372cea252f4e9b7b1d} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+flatten (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{\doxymbox{\hyperlink{struct_proto}{Proto}} \texorpdfstring{$\ast$}{*}}]{f}{, }\item[{int}]{flags}{, }\item[{unsigned int}]{seed}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{log\+\_\+path}{}\end{DoxyParamCaption})}



Applies control flow flattening to a function prototype. 


\begin{DoxyParams}{Parameters}
{\em L} & Lua state. \\
\hline
{\em f} & Function prototype to obfuscate. \\
\hline
{\em flags} & Combination of obfuscation mode flags. \\
\hline
{\em seed} & Random seed for repeatable results. \\
\hline
{\em log\+\_\+path} & Optional file path to write transformation logs (NULL to disable). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, error code on failure. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_afc2a08274c6ac8497277cfe08d0e7473}\index{lobfuscate.h@{lobfuscate.h}!luaO\_freeMetadata@{luaO\_freeMetadata}}
\index{luaO\_freeMetadata@{luaO\_freeMetadata}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_freeMetadata()}{luaO\_freeMetadata()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_afc2a08274c6ac8497277cfe08d0e7473} 
LUAI\+\_\+\+FUNC void lua\+O\+\_\+free\+Metadata (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{\doxymbox{\hyperlink{struct_c_f_f_metadata}{CFFMetadata}} \texorpdfstring{$\ast$}{*}}]{metadata}{}\end{DoxyParamCaption})}



Frees allocated metadata. 


\begin{DoxyParams}{Parameters}
{\em L} & Lua state. \\
\hline
{\em metadata} & Pointer to metadata structure. \\
\hline
\end{DoxyParams}
\Hypertarget{lobfuscate_8h_aad2643292effded4bc9e7a8f68f3ee0b}\index{lobfuscate.h@{lobfuscate.h}!luaO\_generateDispatcher@{luaO\_generateDispatcher}}
\index{luaO\_generateDispatcher@{luaO\_generateDispatcher}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_generateDispatcher()}{luaO\_generateDispatcher()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_aad2643292effded4bc9e7a8f68f3ee0b} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+generate\+Dispatcher (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}}]{ctx}{}\end{DoxyParamCaption})}



Generates the dispatcher code. 


\begin{DoxyParams}{Parameters}
{\em ctx} & CFF context. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, error code on failure. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_ac82a9fa198a5103105d3aebe7652249c}\index{lobfuscate.h@{lobfuscate.h}!luaO\_generateNestedDispatcher@{luaO\_generateNestedDispatcher}}
\index{luaO\_generateNestedDispatcher@{luaO\_generateNestedDispatcher}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_generateNestedDispatcher()}{luaO\_generateNestedDispatcher()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_ac82a9fa198a5103105d3aebe7652249c} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+generate\+Nested\+Dispatcher (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}}]{ctx}{}\end{DoxyParamCaption})}



Generates a nested dispatcher (multi-\/layered state machine). 


\begin{DoxyParams}{Parameters}
{\em ctx} & CFF context. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, error code on failure. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_a281f7d60aebebe1c6a9b30ea4340aae3}\index{lobfuscate.h@{lobfuscate.h}!luaO\_getJumpTarget@{luaO\_getJumpTarget}}
\index{luaO\_getJumpTarget@{luaO\_getJumpTarget}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_getJumpTarget()}{luaO\_getJumpTarget()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a281f7d60aebebe1c6a9b30ea4340aae3} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+get\+Jump\+Target (\begin{DoxyParamCaption}\item[{Instruction}]{inst}{, }\item[{int}]{pc}{}\end{DoxyParamCaption})}



Gets the target PC of a jump instruction. 


\begin{DoxyParams}{Parameters}
{\em inst} & The instruction. \\
\hline
{\em pc} & Current PC. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Target PC. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_af9480cb85330430997eee5affa96d5c8}\index{lobfuscate.h@{lobfuscate.h}!luaO\_identifyBlocks@{luaO\_identifyBlocks}}
\index{luaO\_identifyBlocks@{luaO\_identifyBlocks}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_identifyBlocks()}{luaO\_identifyBlocks()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_af9480cb85330430997eee5affa96d5c8} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+identify\+Blocks (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}}]{ctx}{}\end{DoxyParamCaption})}



Identifies basic blocks in the function code. 


\begin{DoxyParams}{Parameters}
{\em ctx} & CFF context. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, error code on failure. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_a6ef5018a88ffab9c5f5d288f6a74d9f2}\index{lobfuscate.h@{lobfuscate.h}!luaO\_isBlockTerminator@{luaO\_isBlockTerminator}}
\index{luaO\_isBlockTerminator@{luaO\_isBlockTerminator}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_isBlockTerminator()}{luaO\_isBlockTerminator()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a6ef5018a88ffab9c5f5d288f6a74d9f2} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+is\+Block\+Terminator (\begin{DoxyParamCaption}\item[{Op\+Code}]{op}{}\end{DoxyParamCaption})}



Checks if an opcode terminates a basic block. 


\begin{DoxyParams}{Parameters}
{\em op} & Opcode to check. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if terminator, 0 otherwise. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_a0d6dabaf9252ea78e2b4a9bc4be129f1}\index{lobfuscate.h@{lobfuscate.h}!luaO\_isJumpInstruction@{luaO\_isJumpInstruction}}
\index{luaO\_isJumpInstruction@{luaO\_isJumpInstruction}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_isJumpInstruction()}{luaO\_isJumpInstruction()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a0d6dabaf9252ea78e2b4a9bc4be129f1} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+is\+Jump\+Instruction (\begin{DoxyParamCaption}\item[{Op\+Code}]{op}{}\end{DoxyParamCaption})}



Checks if an opcode is a jump instruction. 


\begin{DoxyParams}{Parameters}
{\em op} & Opcode to check. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if jump, 0 otherwise. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_a737a42bcf0da54a52f38a3346262c3fc}\index{lobfuscate.h@{lobfuscate.h}!luaO\_serializeMetadata@{luaO\_serializeMetadata}}
\index{luaO\_serializeMetadata@{luaO\_serializeMetadata}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_serializeMetadata()}{luaO\_serializeMetadata()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_a737a42bcf0da54a52f38a3346262c3fc} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+serialize\+Metadata (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{\doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}}]{ctx}{, }\item[{void \texorpdfstring{$\ast$}{*}}]{buffer}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{size}{}\end{DoxyParamCaption})}



Serializes flattening metadata for storage. 


\begin{DoxyParams}{Parameters}
{\em L} & Lua state. \\
\hline
{\em ctx} & CFF context. \\
\hline
{\em buffer} & Output buffer. \\
\hline
{\em size} & Pointer to buffer size (updated on return). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, error code on failure. 
\end{DoxyReturn}
\Hypertarget{lobfuscate_8h_ab8bc2edf07a551a9fd6d59225e2eb781}\index{lobfuscate.h@{lobfuscate.h}!luaO\_shuffleBlocks@{luaO\_shuffleBlocks}}
\index{luaO\_shuffleBlocks@{luaO\_shuffleBlocks}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_shuffleBlocks()}{luaO\_shuffleBlocks()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_ab8bc2edf07a551a9fd6d59225e2eb781} 
LUAI\+\_\+\+FUNC void lua\+O\+\_\+shuffle\+Blocks (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{struct_c_f_f_context}{CFFContext}} \texorpdfstring{$\ast$}{*}}]{ctx}{}\end{DoxyParamCaption})}



Shuffles basic block order. 


\begin{DoxyParams}{Parameters}
{\em ctx} & CFF context. \\
\hline
\end{DoxyParams}
\Hypertarget{lobfuscate_8h_aadfdcce31b2ed1398b58f391b507b247}\index{lobfuscate.h@{lobfuscate.h}!luaO\_unflatten@{luaO\_unflatten}}
\index{luaO\_unflatten@{luaO\_unflatten}!lobfuscate.h@{lobfuscate.h}}
\doxysubsubsection{\texorpdfstring{luaO\_unflatten()}{luaO\_unflatten()}}
{\footnotesize\ttfamily \label{lobfuscate_8h_aadfdcce31b2ed1398b58f391b507b247} 
LUAI\+\_\+\+FUNC int lua\+O\+\_\+unflatten (\begin{DoxyParamCaption}\item[{\doxymbox{\hyperlink{structlua___state}{lua\+\_\+\+State}} \texorpdfstring{$\ast$}{*}}]{L}{, }\item[{\doxymbox{\hyperlink{struct_proto}{Proto}} \texorpdfstring{$\ast$}{*}}]{f}{, }\item[{\doxymbox{\hyperlink{struct_c_f_f_metadata}{CFFMetadata}} \texorpdfstring{$\ast$}{*}}]{metadata}{}\end{DoxyParamCaption})}



Reverses control flow flattening. 


\begin{DoxyParams}{Parameters}
{\em L} & Lua state. \\
\hline
{\em f} & Obfuscated function prototype. \\
\hline
{\em metadata} & Flattening metadata. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, error code on failure. 
\end{DoxyReturn}
